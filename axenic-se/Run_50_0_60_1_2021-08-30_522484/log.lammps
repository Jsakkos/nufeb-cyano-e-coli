LAMMPS (20 Nov 2019)
# NUFEB simulation

atom_style	bio
atom_modify	map array sort 1000 5.0e-7
boundary	ff ff ff
newton		off
processors  * * *

comm_modify	vel yes
#variable reps loop 1
read_data_bio atom_50_0_60_1_2021-08-30.in
  orthogonal box = (0 0 0) to (0.0001 0.0001 5e-05)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  50 atoms
  4 nutrients
#shell mkdir Run_50_0_60_1
#shell cd Run_50_0_60_1
##############Define initial particle distribution##############

lattice sc 1e-6 origin 0 0 0
Lattice spacing in x,y,z = 100 100 100
region reg block 0 1000 0 1000 0 100

group CYANO type 1
50 atoms in group CYANO
group ECW type 2
0 atoms in group ECW

neighbor	5e-7 bin
neigh_modify	delay 0 one 5000

##############Define DEM Variables&Commands##############

pair_style  gran/hooke/history 1.e-4 NULL 1.e-5 NULL 0.0 1
pair_coeff  * *

timestep 10

fix 1 all nve/limit 1e-8
fix fv all viscous 1e-5

fix zw all wall/gran hooke/history 2000 NULL 500.0 NULL 1.5 0 zplane  0.0  5e-05

variable kanc equal 50

variable ke equal 5e+10


##############Define IBm Variables##############

#variables used in fix eps_extract
variable EPSdens equal 30
variable EPSratio equal 1.3

#variables used in fix division
variable divDia1 equal 1.96e-6
variable divDia2 equal 1.04e-6

#variables used in fix kinetics
variable diffT equal 1e-4
variable tol equal 1e-11
variable etaHET equal 0.6
variable layer equal -1

#variables used in fix death
#variable deadDia equal 9e-7


##############Define IBm Commands##############

fix k1 all kinetics 100 10 10 5 v_diffT v_layer niter 1000000
fix kgm all kinetics/growth/monod sucexp 0.6
fix g1 all kinetics/diffusion v_tol
fix d1 CYANO divide 100 v_EPSdens v_divDia1 415706
fix d2 ECW divide 100 v_EPSdens v_divDia2 842533
#fix d2 all death 1 v_deadDia demflag 0


##############Define IBm Computes##############

compute myNtypes all ntypes
compute myMass all biomass
compute myCon all avg_con

##############Simulation exit condition##############
variable co2 equal c_myCon[4]
fix 10 all halt 100 v_co2 <= 1e-19

variable light equal c_myCon[1]
fix 11 all halt 100 v_light <= 1e-19

##############Simulation Output##############
dump    id all custom 100 output.lammmps id type diameter x y z
dump    du1 all vtk 100 atom_*.vtu id type diameter x y z
dump    du2 all grid 100 grid_%_*.vti con
dump    du3 all bio 100 ntypes biomass avg_con
dump    traj all bio/hdf5 100 trajectory.h5 id type radius x y z con
thermo_style    custom step cpu atoms c_myNtypes[*] c_myMass[*] c_myCon[*]
thermo		100
thermo_modify	lost ignore


run 10000
Model is defined as a closed system. 
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 5000, page size: 100000
  master list distance cutoff = 2.42e-06
  ghost atom cutoff = 2.42e-06
  binsize = 1.21e-06, bins = 83 83 42
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair gran/hooke/history, perpetual
      attributes: half, newton off, size, history
      pair build: half/size/bin/newtoff
      stencil: half/bin/3d/newtoff
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 11.91 | 12.13 | 12.35 Mbytes
Step CPU Atoms c_myNtypes[1] c_myNtypes[2] c_myMass[1] c_myMass[2] c_myCon[1] c_myCon[2] c_myCon[3] c_myCon[4] 
       0            0       50           50            0 4.7659007e-14            0          0.1        0.009     3.42e-20       0.0299 
number of iterations: 321763 
     100    5.1398035       50           50            0 4.8510591e-14            0          0.1 0.0090033854  0.005663831  0.029894364 
number of iterations: 24623 
     200    5.7372253       50           50            0 4.9377392e-14            0          0.1 0.0090034458   0.01125181  0.029894263 
number of iterations: 24717 
     300    6.3255825       50           50            0 5.0259681e-14            0          0.1 0.0090035074   0.01693882   0.02989416 
number of iterations: 24811 
     400    6.9387159       50           50            0 5.1157735e-14            0          0.1 0.0090035701  0.022727107  0.029894056 
number of iterations: 24920 
     500    7.5437377       51           51            0 5.2071836e-14            0          0.1 0.0090036339  0.028618659   0.02989395 
number of iterations: 24999 
     600    8.1620362       52           52            0 5.300227e-14            0          0.1 0.0090036988  0.034615404  0.029893842 
number of iterations: 25093 
     700    8.7935262       53           53            0 5.394933e-14            0          0.1 0.0090037649  0.040719239  0.029893732 
number of iterations: 23189 
     800    9.3844607       56           56            0 5.4913312e-14            0          0.1 0.0090038128  0.046932083  0.029893652 
number of iterations: 25259 
     900     10.00712       59           59            0 5.5894518e-14            0          0.1  0.009003881  0.053255895  0.029893538 
number of iterations: 25345 
    1000    10.642218       60           60            0 5.6893257e-14            0          0.1 0.0090039503  0.059692664  0.029893423 
number of iterations: 25439 
    1100    11.250022       61           61            0 5.7909841e-14            0          0.1 0.0090040209  0.066244413  0.029893305 
number of iterations: 25547 
    1200    11.874481       62           62            0 5.8944591e-14            0          0.1 0.0090040928  0.072913201  0.029893186 
number of iterations: 25628 
    1300    12.510644       63           63            0 5.9997829e-14            0          0.1 0.0090041659  0.079701121  0.029893064 
number of iterations: 25722 
    1400    13.155187       63           63            0 6.1069887e-14            0          0.1 0.0090042403  0.086610306   0.02989294 
number of iterations: 25817 
    1500    13.816208       64           64            0  6.21611e-14            0          0.1 0.0090043161  0.093642922  0.029892814 
number of iterations: 26428 
    1600    14.482414       65           65            0 6.3271812e-14            0          0.1 0.0090043994   0.10080117  0.029892675 
number of iterations: 26015 
    1700     15.12588       66           66            0 6.440237e-14            0          0.1  0.009004478    0.1080873  0.029892544 
number of iterations: 24553 
    1800    15.717204       68           68            0 6.555313e-14            0          0.1 0.0090045367   0.11550359  0.029892447 
number of iterations: 26179 
    1900    16.369366       68           68            0 6.6724451e-14            0          0.1 0.0090046178   0.12305238  0.029892312 
number of iterations: 24732 
    2000      16.9743       72           72            0 6.7916702e-14            0          0.1 0.0090046789   0.13073603   0.02989221 
number of iterations: 24901 
    2100    17.602157       73           73            0 6.9130256e-14            0          0.1 0.0090047445   0.13855695    0.0298921 
number of iterations: 26416 
    2200    18.261498       73           73            0 7.0365495e-14            0          0.1 0.0090048293    0.1465176  0.029891959 
number of iterations: 26510 
    2300      18.9136       74           74            0 7.1622805e-14            0          0.1 0.0090049156   0.15462048  0.029891816 
number of iterations: 26605 
    2400    19.567981       74           74            0 7.290258e-14            0          0.1 0.0090050035   0.16286813  0.029891669 
number of iterations: 26700 
    2500    20.224611       74           74            0 7.4205224e-14            0          0.1 0.0090050929   0.17126314   0.02989152 
number of iterations: 26794 
    2600    20.883068       75           75            0 7.5531143e-14            0          0.1 0.0090051839   0.17980814  0.029891369 
number of iterations: 26889 
    2700    21.522096       76           76            0 7.6880754e-14            0          0.1 0.0090052765   0.18850581  0.029891215 
number of iterations: 26983 
    2800    22.238756       78           78            0 7.825448e-14            0          0.1 0.0090053708   0.19735888  0.029891058 
number of iterations: 27078 
    2900    22.873052       78           78            0 7.9652752e-14            0          0.1 0.0090054668   0.20637013  0.029890898 
number of iterations: 27181 
    3000    23.589426       79           79            0 8.1076009e-14            0          0.1 0.0090055644   0.21554238  0.029890735 
number of iterations: 27267 
    3100     24.22728       80           80            0 8.2524697e-14            0          0.1 0.0090056639   0.22487852   0.02989057 
number of iterations: 27368 
    3200    24.900191       80           80            0 8.3999271e-14            0          0.1 0.0090057651   0.23438137  0.029890401 
number of iterations: 27456 
    3300    25.538536       81           81            0 8.5500192e-14            0          0.1 0.0090058681   0.24405401   0.02989023 
number of iterations: 27550 
    3400    26.212439       82           82            0 8.7027932e-14            0          0.1  0.009005973   0.25389949  0.029890055 
number of iterations: 27645 
    3500    26.883175       82           82            0 8.8582971e-14            0          0.1 0.0090060797   0.26392087  0.029889877 
number of iterations: 27740 
    3600    27.573232       83           83            0 9.0165795e-14            0          0.1 0.0090061883   0.27412132  0.029889696 
number of iterations: 27835 
    3700    28.285128       86           86            0 9.1776901e-14            0          0.1 0.0090062989   0.28450401  0.029889512 
number of iterations: 27929 
    3800    28.965426       88           88            0 9.3416795e-14            0          0.1 0.0090064115   0.29507223  0.029889325 
number of iterations: 28024 
    3900    29.645919       89           89            0 9.5085991e-14            0          0.1  0.009006526   0.30582928  0.029889134 
number of iterations: 28119 
    4000    30.309917       91           91            0 9.6785013e-14            0          0.1 0.0090066426   0.31677852   0.02988894 
number of iterations: 28182 
    4100    30.978678       95           95            0 9.8514393e-14            0          0.1 0.0090067573   0.32792338  0.029888749 
number of iterations: 27241 
    4200    31.721091       96           96            0 1.0027467e-13            0          0.1 0.0090068581   0.33926735  0.029888581 
number of iterations: 28385 
    4300    32.404638       97           97            0 1.0206641e-13            0          0.1 0.0090069807   0.35081402  0.029888377 
number of iterations: 28480 
    4400    33.094552       98           98            0 1.0389016e-13            0          0.1 0.0090071054     0.362567  0.029888169 
number of iterations: 28575 
    4500    33.805919       99           99            0 1.0574649e-13            0          0.1 0.0090072324   0.37452998  0.029887958 
number of iterations: 28679 
    4600     34.48903      103          103            0  1.07636e-13            0          0.1 0.0090073616    0.3867067  0.029887743 
number of iterations: 28765 
    4700    35.175844      105          105            0 1.0955927e-13            0          0.1 0.0090074932     0.399101  0.029887524 
number of iterations: 28860 
    4800    35.858161      106          106            0 1.115169e-13            0          0.1 0.0090076271   0.41171675  0.029887301 
number of iterations: 28955 
    4900    36.545788      109          109            0 1.1350951e-13            0          0.1 0.0090077633   0.42455791  0.029887074 
number of iterations: 29056 
    5000    37.225428      111          111            0 1.1553773e-13            0          0.1 0.0090079021   0.43762852  0.029886843 
number of iterations: 29145 
    5100    37.926956      114          114            0 1.1760219e-13            0          0.1 0.0090080433   0.45093267  0.029886608 
number of iterations: 29248 
    5200    38.694161      117          117            0 1.1970353e-13            0          0.1  0.009008187    0.4644745  0.029886368 
number of iterations: 29034 
    5300    39.389843      122          122            0 1.2184243e-13            0          0.1  0.009008327   0.47825832  0.029886135 
number of iterations: 29996 
    5400    40.116137      127          127            0 1.2401954e-13            0          0.1 0.0090084896   0.49228839  0.029885865 
number of iterations: 29530 
    5500    40.808636      127          127            0 1.2623555e-13            0          0.1 0.0090086413   0.50656915  0.029885612 
number of iterations: 29625 
    5600    41.526397      128          128            0 1.2849116e-13            0          0.1 0.0090087957   0.52110507  0.029885355 
number of iterations: 29720 
    5700    42.230043      129          129            0 1.3078707e-13            0          0.1 0.0090089528   0.53590072  0.029885093 
number of iterations: 30504 
    5800    42.967303      134          134            0 1.3312401e-13            0          0.1 0.0090091305   0.55096071  0.029884797 
number of iterations: 29925 
    5900    43.737545      136          136            0 1.355027e-13            0          0.1 0.0090092937   0.56628978  0.029884526 
number of iterations: 30432 
    6000    44.487738      138          138            0 1.379239e-13            0          0.1 0.0090094707   0.58189274  0.029884231 
number of iterations: 30122 
    6100    45.192965      144          144            0 1.4038836e-13            0          0.1 0.0090096399    0.5977745  0.029883949 
number of iterations: 30889 
    6200    45.914418      146          146            0 1.4289685e-13            0          0.1 0.0090098356   0.61394004  0.029883623 
number of iterations: 30323 
    6300    46.628788      146          146            0 1.4545017e-13            0          0.1 0.0090100113   0.63039443  0.029883331 
number of iterations: 31122 
    6400    47.347185      152          152            0 1.4804911e-13            0          0.1 0.0090102157   0.64714284   0.02988299 
number of iterations: 29560 
    6500    48.058889      153          153            0 1.5069448e-13            0          0.1 0.0090103671   0.66419047  0.029882738 
number of iterations: 30606 
    6600    48.805139      155          155            0 1.5338713e-13            0          0.1 0.0090105523   0.68154273   0.02988243 
number of iterations: 30700 
    6700    49.527962      155          155            0 1.5612789e-13            0          0.1 0.0090107409   0.69920502  0.029882116 
number of iterations: 30795 
    6800    50.248423      156          156            0 1.5891762e-13            0          0.1 0.0090109328   0.71718291  0.029881796 
number of iterations: 30890 
    6900    50.991711      157          157            0 1.6175719e-13            0          0.1 0.0090111281   0.73548203  0.029881471 
number of iterations: 30985 
    7000    51.738492      157          157            0 1.6464751e-13            0          0.1  0.009011327   0.75410811   0.02988114 
number of iterations: 30460 
    7100    52.471856      159          159            0 1.6758947e-13            0          0.1 0.0090115096   0.77306699  0.029880836 
number of iterations: 31165 
    7200    53.240528      163          163            0  1.70584e-13            0          0.1 0.0090117153   0.79236463  0.029880493 
number of iterations: 31260 
    7300    53.985554      165          165            0 1.7363203e-13            0          0.1 0.0090119246   0.81200709  0.029880145 
number of iterations: 31749 
    7400    54.712561      170          170            0 1.7673453e-13            0          0.1  0.009012152   0.83200052  0.029879766 
number of iterations: 31459 
    7500    55.474427      173          173            0 1.7989247e-13            0          0.1 0.0090123691   0.85235119  0.029879405 
number of iterations: 31553 
    7600     56.28161      175          175            0 1.8310683e-13            0          0.1 0.0090125902   0.87306548  0.029879037 
number of iterations: 31648 
    7700    57.008631      179          179            0 1.8637862e-13            0          0.1 0.0090128151   0.89414988  0.029878662 
number of iterations: 31743 
    7800    57.762138      180          180            0 1.8970888e-13            0          0.1 0.0090130441   0.91561103  0.029878281 
number of iterations: 31839 
    7900    58.558212      183          183            0 1.9309864e-13            0          0.1 0.0090132772   0.93745564  0.029877893 
number of iterations: 32353 
    8000    59.323716      187          187            0 1.9654897e-13            0          0.1 0.0090135341   0.95969058  0.029877465 
number of iterations: 31583 
    8100    60.077644      191          191            0 2.0006095e-13            0          0.1 0.0090137559    0.9823228  0.029877096 
number of iterations: 32125 
    8200    60.822557      195          195            0 2.0363568e-13            0          0.1 0.0090140017    1.0053594  0.029876686 
number of iterations: 31429 
    8300     61.57027      198          198            0 2.0727429e-13            0          0.1 0.0090142213    1.0288076  0.029876321 
number of iterations: 31790 
    8400    62.338258      203          203            0 2.1097791e-13            0          0.1 0.0090144567    1.0526749  0.029875929 
number of iterations: 32678 
    8500    63.138983      208          208            0 2.1474771e-13            0          0.1 0.0090147268    1.0769685  0.029875479 
number of iterations: 31921 
    8600    63.917687      214          214            0 2.1858487e-13            0          0.1  0.009014963    1.1016963  0.029875086 
number of iterations: 32399 
    8700     64.65895      222          222            0 2.2249059e-13            0          0.1 0.0090152236    1.1268658  0.029874652 
number of iterations: 33464 
    8800    65.451286      227          227            0 2.264661e-13            0          0.1  0.009015536    1.1524851  0.029874132 
number of iterations: 32775 
    8900    66.233989      230          230            0 2.3051264e-13            0          0.1 0.0090158136     1.178562  0.029873669 
number of iterations: 32874 
    9000    67.067896      235          235            0 2.3463149e-13            0          0.1 0.0090160962     1.205105  0.029873199 
number of iterations: 33263 
    9100    67.878477      238          238            0 2.3882394e-13            0          0.1 0.0090163982    1.2321222  0.029872696 
number of iterations: 33068 
    9200    68.693427      241          241            0 2.4309129e-13            0          0.1 0.0090166912    1.2596222  0.029872208 
number of iterations: 33513 
    9300    69.472776      249          249            0 2.474349e-13            0          0.1 0.0090170074    1.2876135  0.029871682 
number of iterations: 33051 
    9400    70.245565      251          251            0 2.5185612e-13            0          0.1  0.009017302     1.316105  0.029871191 
number of iterations: 33357 
    9500    71.048652      253          253            0 2.5635633e-13            0          0.1 0.0090176111    1.3451056  0.029870676 
number of iterations: 33452 
    9600    71.816431      259          259            0 2.6093696e-13            0          0.1 0.0090179258    1.3746244  0.029870152 
number of iterations: 33547 
    9700    72.605012      264          264            0 2.6559943e-13            0          0.1 0.0090182461    1.4046706  0.029869619 
number of iterations: 33193 
    9800    73.421524      269          269            0 2.7034521e-13            0          0.1 0.0090185455    1.4352536  0.029869121 
number of iterations: 33730 
    9900    74.207533      273          273            0 2.7517579e-13            0          0.1 0.0090188769    1.4663831  0.029868569 
number of iterations: 33826 
   10000    75.007716      277          277            0 2.8009269e-13            0          0.1 0.0090192142    1.4980688  0.029868007 
Loop time of 75.0078 on 8 procs for 10000 steps with 277 atoms

Performance: 115188078.130 tau/day, 133.320 timesteps/s
88.5% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.010482   | 0.011503   | 0.012444   |   0.6 |  0.02
Neigh   | 0.0070879  | 0.0081943  | 0.009274   |   1.1 |  0.01
Comm    | 0.044866   | 0.051619   | 0.060149   |   2.2 |  0.07
Output  | 13.004     | 13.005     | 13.007     |   0.0 | 17.34
Modify  | 61.866     | 61.867     | 61.868     |   0.0 | 82.48
Other   |            | 0.06464    |            |       |  0.09

Nlocal:    34.625 ave 43 max 25 min
Histogram: 1 0 2 1 0 0 0 1 2 1
Nghost:    7.625 ave 11 max 5 min
Histogram: 2 0 0 3 0 0 1 0 1 1
Neighs:    40.25 ave 48 max 30 min
Histogram: 1 0 1 1 0 0 2 1 1 1

Total # of neighbors = 322
Ave neighs/atom = 1.16245
Neighbor list builds = 110
Dangerous builds = 0
#shell cd ..
#clear
#next reps
#jump SELF
Total wall time: 0:01:15
