LAMMPS (20 Nov 2019)
# NUFEB simulation

atom_style	bio
atom_modify	map array sort 1000 5.0e-7
boundary	ff ff ff
newton		off
processors  * * *

comm_modify	vel yes
#variable reps loop 1
read_data_bio atom_50_0_10_1_2021-08-30.in
  orthogonal box = (0 0 0) to (0.0001 0.0001 5e-05)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  50 atoms
  4 nutrients
#shell mkdir Run_50_0_10_1
#shell cd Run_50_0_10_1
##############Define initial particle distribution##############

lattice sc 1e-6 origin 0 0 0
Lattice spacing in x,y,z = 100 100 100
region reg block 0 1000 0 1000 0 100

group CYANO type 1
50 atoms in group CYANO
group ECW type 2
0 atoms in group ECW

neighbor	5e-7 bin
neigh_modify	delay 0 one 5000

##############Define DEM Variables&Commands##############

pair_style  gran/hooke/history 1.e-4 NULL 1.e-5 NULL 0.0 1
pair_coeff  * *

timestep 10

fix 1 all nve/limit 1e-8
fix fv all viscous 1e-5

fix zw all wall/gran hooke/history 2000 NULL 500.0 NULL 1.5 0 zplane  0.0  5e-05

variable kanc equal 50

variable ke equal 5e+10


##############Define IBm Variables##############

#variables used in fix eps_extract
variable EPSdens equal 30
variable EPSratio equal 1.3

#variables used in fix division
variable divDia1 equal 1.96e-6
variable divDia2 equal 1.04e-6

#variables used in fix kinetics
variable diffT equal 1e-4
variable tol equal 1e-11
variable etaHET equal 0.6
variable layer equal -1

#variables used in fix death
#variable deadDia equal 9e-7


##############Define IBm Commands##############

fix k1 all kinetics 100 10 10 5 v_diffT v_layer niter 1000000
fix kgm all kinetics/growth/monod sucexp 0.1
fix g1 all kinetics/diffusion v_tol
fix d1 CYANO divide 100 v_EPSdens v_divDia1 510091
fix d2 ECW divide 100 v_EPSdens v_divDia2 625037
#fix d2 all death 1 v_deadDia demflag 0


##############Define IBm Computes##############

compute myNtypes all ntypes
compute myMass all biomass
compute myCon all avg_con

##############Simulation exit condition##############
variable co2 equal c_myCon[4]
fix 10 all halt 100 v_co2 <= 1e-19

variable light equal c_myCon[1]
fix 11 all halt 100 v_light <= 1e-19

##############Simulation Output##############
dump    id all custom 100 output.lammmps id type diameter x y z
dump    du1 all vtk 100 atom_*.vtu id type diameter x y z
dump    du2 all grid 100 grid_%_*.vti con
dump    du3 all bio 100 ntypes biomass avg_con
dump    traj all bio/hdf5 100 trajectory.h5 id type radius x y z con
thermo_style    custom step cpu atoms c_myNtypes[*] c_myMass[*] c_myCon[*]
thermo		100
thermo_modify	lost ignore


run 10000
Model is defined as a closed system. 
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 5000, page size: 100000
  master list distance cutoff = 2.4e-06
  ghost atom cutoff = 2.4e-06
  binsize = 1.2e-06, bins = 84 84 42
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair gran/hooke/history, perpetual
      attributes: half, newton off, size, history
      pair build: half/size/bin/newtoff
      stencil: half/bin/3d/newtoff
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.981 | 10.24 | 12.36 Mbytes
Step CPU Atoms c_myNtypes[1] c_myNtypes[2] c_myMass[1] c_myMass[2] c_myCon[1] c_myCon[2] c_myCon[3] c_myCon[4] 
       0            0       50           50            0 4.3060302e-14            0          0.1        0.009     3.42e-20       0.0299 
number of iterations: 325608 
     100    4.9477465       50           50            0 4.391715e-14            0          0.1 0.0090013294 0.00085320458  0.029897787 
number of iterations: 20591 
     200    5.5168576       50           50            0 4.4791047e-14            0          0.1 0.0090013559 0.0016964222  0.029897743 
number of iterations: 20678 
     300    6.0764217       50           50            0 4.5682335e-14            0          0.1 0.0090013829 0.0025562917  0.029897698 
number of iterations: 20765 
     400    6.6348283       50           50            0 4.6591357e-14            0          0.1 0.0090014104 0.0034332294  0.029897652 
number of iterations: 20851 
     500    7.1710669       50           50            0 4.7518469e-14            0          0.1 0.0090014384   0.00432759  0.029897605 
number of iterations: 20938 
     600    7.7075341       51           51            0 4.8464028e-14            0          0.1 0.0090014671 0.0052397275  0.029897558 
number of iterations: 21025 
     700     8.222585       53           53            0 4.9428403e-14            0          0.1 0.0090014963 0.0061700002  0.029897509 
number of iterations: 21112 
     800    8.7887891       53           53            0 5.0411968e-14            0          0.1  0.009001526 0.0071187718   0.02989746 
number of iterations: 21232 
     900    9.3259097       55           55            0 5.1415105e-14            0          0.1 0.0090015564 0.0080864108  0.029897409 
number of iterations: 21286 
    1000    9.8617306       56           56            0 5.2438203e-14            0          0.1 0.0090015874 0.0090732959  0.029897357 
number of iterations: 21373 
    1100    10.397996       57           57            0 5.3481659e-14            0          0.1  0.009001619  0.010079811  0.029897305 
number of iterations: 21459 
    1200    10.950957       57           57            0 5.4545879e-14            0          0.1 0.0090016512  0.011106348  0.029897251 
number of iterations: 21872 
    1300    11.511418       58           58            0 5.5631276e-14            0          0.1  0.009001686  0.012153304  0.029897193 
number of iterations: 21640 
    1400    12.095903       59           59            0 5.673827e-14            0          0.1 0.0090017196  0.013221089  0.029897137 
number of iterations: 21726 
    1500    12.652529       59           59            0 5.7867292e-14            0          0.1 0.0090017538  0.014310115   0.02989708 
number of iterations: 21813 
    1600    13.237555       60           60            0 5.9018781e-14            0          0.1 0.0090017887  0.015420808  0.029897022 
number of iterations: 21900 
    1700    13.808885       61           61            0 6.0193183e-14            0          0.1 0.0090018243  0.016553597  0.029896963 
number of iterations: 20794 
    1800    14.349222       62           62            0 6.1390953e-14            0          0.1 0.0090018517  0.017708922  0.029896917 
number of iterations: 22053 
    1900    14.908833       63           63            0 6.2612558e-14            0          0.1 0.0090018886  0.018887233  0.029896856 
number of iterations: 22140 
    2000    15.473762       65           65            0 6.3858472e-14            0          0.1 0.0090019262  0.020088988  0.029896793 
number of iterations: 22227 
    2100     16.04635       65           65            0 6.5129177e-14            0          0.1 0.0090019645  0.021314652   0.02989673 
number of iterations: 22317 
    2200    16.655976       65           65            0 6.6425169e-14            0          0.1 0.0090020036  0.022564703  0.029896664 
number of iterations: 22421 
    2300    17.230608       66           66            0 6.7746948e-14            0          0.1 0.0090020435  0.023839625  0.029896598 
number of iterations: 22525 
    2400    17.795528       68           68            0 6.909503e-14            0          0.1 0.0090020841  0.025139914   0.02989653 
number of iterations: 22630 
    2500    18.394471       70           70            0 7.0469936e-14            0          0.1 0.0090021256  0.026466075  0.029896461 
number of iterations: 22734 
    2600    18.966741       73           73            0 7.1872202e-14            0          0.1 0.0090021679  0.027818621  0.029896391 
number of iterations: 22838 
    2700    19.527935       73           73            0 7.3302371e-14            0          0.1 0.0090022111   0.02919808  0.029896319 
number of iterations: 22943 
    2800    20.113675       73           73            0 7.4760998e-14            0          0.1 0.0090022551  0.030604986  0.029896246 
number of iterations: 23047 
    2900    20.693493       75           75            0 7.624865e-14            0          0.1 0.0090022999  0.032039885  0.029896171 
number of iterations: 23151 
    3000    21.284403       76           76            0 7.7765905e-14            0          0.1 0.0090023457  0.033503334  0.029896095 
number of iterations: 22832 
    3100    21.886708       77           77            0 7.9313351e-14            0          0.1 0.0090023896  0.034995906  0.029896022 
number of iterations: 23352 
    3200    22.490832       79           79            0 8.089159e-14            0          0.1 0.0090024371  0.036518176  0.029895943 
number of iterations: 23475 
    3300    23.078751       81           81            0 8.2501233e-14            0          0.1 0.0090024856  0.038070736  0.029895862 
number of iterations: 23570 
    3400    23.693731       84           84            0 8.4142907e-14            0          0.1 0.0090025351  0.039654186  0.029895779 
number of iterations: 23666 
    3500    24.260104       85           85            0 8.5817248e-14            0          0.1 0.0090025855  0.041269144  0.029895695 
number of iterations: 23771 
    3600    24.848854       88           88            0 8.7524906e-14            0          0.1  0.009002637  0.042916236   0.02989561 
number of iterations: 23891 
    3700    25.462921       91           91            0 8.9266544e-14            0          0.1 0.0090026895  0.044596102  0.029895522 
number of iterations: 23980 
    3800    26.101291       93           93            0 9.1042838e-14            0          0.1  0.009002743  0.046309394  0.029895433 
number of iterations: 24085 
    3900    26.719094       94           94            0 9.2854479e-14            0          0.1 0.0090027976  0.048056777  0.029895342 
number of iterations: 24183 
    4000    27.319086       96           96            0 9.4702169e-14            0          0.1 0.0090028533  0.049838932   0.02989525 
number of iterations: 24294 
    4100    27.916104       97           97            0 9.6586626e-14            0          0.1   0.00900291  0.051656549  0.029895155 
number of iterations: 24399 
    4200    28.598658       99           99            0 9.8508581e-14            0          0.1  0.009002968  0.053510333  0.029895059 
number of iterations: 24504 
    4300    29.195428      100          100            0 1.0046878e-13            0          0.1  0.009003027  0.055401004   0.02989496 
number of iterations: 24609 
    4400     29.81647      101          101            0 1.0246799e-13            0          0.1 0.0090030873  0.057329296   0.02989486 
number of iterations: 24713 
    4500    30.432929      102          102            0 1.0450697e-13            0          0.1 0.0090031487  0.059295958  0.029894758 
number of iterations: 24818 
    4600    31.045885      103          103            0 1.0658653e-13            0          0.1 0.0090032114  0.061301753  0.029894653 
number of iterations: 24923 
    4700    31.684714      104          104            0 1.0870747e-13            0          0.1 0.0090032753   0.06334746  0.029894547 
number of iterations: 25028 
    4800    32.334214      104          104            0 1.1087062e-13            0          0.1 0.0090033404  0.065433873  0.029894438 
number of iterations: 25133 
    4900    32.952088      105          105            0 1.1307681e-13            0          0.1 0.0090034069  0.067561803  0.029894328 
number of iterations: 25238 
    5000    33.558009      108          108            0 1.153269e-13            0          0.1 0.0090034747  0.069732074  0.029894215 
number of iterations: 24810 
    5100    34.166704      114          114            0 1.1762176e-13            0          0.1 0.0090035378  0.071945529   0.02989411 
number of iterations: 25438 
    5200    34.822279      115          115            0 1.1996229e-13            0          0.1 0.0090036082  0.074203028  0.029893993 
number of iterations: 25543 
    5300    35.428993      118          118            0 1.2234939e-13            0          0.1   0.00900368  0.076505447  0.029893873 
number of iterations: 25644 
    5400     36.05574      121          121            0 1.2478399e-13            0          0.1 0.0090037532  0.078853677  0.029893751 
number of iterations: 25753 
    5500    36.720303      124          124            0 1.2726704e-13            0          0.1 0.0090038279  0.081248633  0.029893627 
number of iterations: 25858 
    5600    37.405265      128          128            0 1.297995e-13            0          0.1 0.0090039041  0.083691245    0.0298935 
number of iterations: 26575 
    5700    38.064313      130          130            0 1.3238234e-13            0          0.1 0.0090039912  0.086182464  0.029893355 
number of iterations: 26081 
    5800    38.688786      132          132            0 1.3501659e-13            0          0.1 0.0090040706  0.088723255  0.029893223 
number of iterations: 26186 
    5900    39.323593      134          134            0 1.3770325e-13            0          0.1 0.0090041517  0.091314603  0.029893088 
number of iterations: 26291 
    6000    39.965338      137          137            0 1.4044338e-13            0          0.1 0.0090042343  0.093957515   0.02989295 
number of iterations: 26397 
    6100    40.625016      140          140            0 1.4323803e-13            0          0.1 0.0090043185  0.096653016   0.02989281 
number of iterations: 26495 
    6200    41.285586      146          146            0 1.4608829e-13            0          0.1 0.0090044045  0.099402155  0.029892667 
number of iterations: 26607 
    6300    42.005202      148          148            0 1.4899526e-13            0          0.1 0.0090044921     0.102206  0.029892521 
number of iterations: 26712 
    6400    42.681955      150          150            0 1.5196008e-13            0          0.1 0.0090045815   0.10506563  0.029892372 
number of iterations: 26823 
    6500    43.374029      155          155            0 1.549839e-13            0          0.1 0.0090046727   0.10798216   0.02989222 
number of iterations: 26923 
    6600    44.045124      157          157            0 1.5806789e-13            0          0.1 0.0090047657   0.11095673  0.029892065 
number of iterations: 27027 
    6700     44.73091      159          159            0 1.6121324e-13            0          0.1 0.0090048605   0.11399049  0.029891907 
number of iterations: 27141 
    6800    45.426683      162          162            0 1.6442118e-13            0          0.1 0.0090049572   0.11708462  0.029891746 
number of iterations: 27700 
    6900    46.142292      168          168            0 1.6769296e-13            0          0.1 0.0090050648   0.12024031  0.029891567 
number of iterations: 27353 
    7000     46.91494      170          170            0 1.7102984e-13            0          0.1 0.0090051656    0.1234588  0.029891399 
number of iterations: 27463 
    7100    47.598677      177          177            0 1.7443312e-13            0          0.1 0.0090052684   0.12674133  0.029891228 
number of iterations: 27564 
    7200    48.349995      179          179            0 1.7790413e-13            0          0.1 0.0090053732   0.13008918  0.029891054 
number of iterations: 27094 
    7300    49.051019      180          180            0 1.814442e-13            0          0.1  0.009005469   0.13350364  0.029890894 
number of iterations: 27766 
    7400    49.747723      183          183            0 1.8505471e-13            0          0.1 0.0090055778   0.13698605  0.029890713 
number of iterations: 27871 
    7500    50.476103      184          184            0 1.8873707e-13            0          0.1 0.0090056888   0.14053775  0.029890528 
number of iterations: 27979 
    7600    51.159644      185          185            0 1.924927e-13            0          0.1  0.009005802   0.14416013   0.02989034 
number of iterations: 28086 
    7700    51.897022      190          190            0 1.9632306e-13            0          0.1 0.0090059175   0.14785459  0.029890147 
number of iterations: 28186 
    7800     52.60267      193          193            0 2.0022965e-13            0          0.1 0.0090060352   0.15162256  0.029889951 
number of iterations: 28299 
    7900    53.377663      196          196            0 2.0421397e-13            0          0.1 0.0090061553    0.1554655  0.029889751 
number of iterations: 28057 
    8000    54.153037      203          203            0 2.0827757e-13            0          0.1 0.0090062708   0.15938492  0.029889559 
number of iterations: 28496 
    8100    54.882887      207          207            0 2.1242203e-13            0          0.1 0.0090063956   0.16338233  0.029889351 
number of iterations: 28602 
    8200    55.603186      211          211            0 2.1664896e-13            0          0.1 0.0090065229   0.16745927  0.029889139 
number of iterations: 28708 
    8300    56.324173      215          215            0 2.2096001e-13            0          0.1 0.0090066527   0.17161735  0.029888923 
number of iterations: 28813 
    8400    57.076878      218          218            0 2.2535683e-13            0          0.1 0.0090067851   0.17585816  0.029888703 
number of iterations: 28921 
    8500       57.808      224          224            0 2.2984115e-13            0          0.1 0.0090069201   0.18018335  0.029888478 
number of iterations: 29121 
    8600    58.571019      229          229            0 2.344147e-13            0          0.1 0.0090070597   0.18459461  0.029888245 
number of iterations: 29131 
    8700    59.304513      233          233            0 2.3907926e-13            0          0.1 0.0090072002   0.18909365  0.029888012 
number of iterations: 29244 
    8800    60.043618      234          234            0 2.4383663e-13            0          0.1 0.0090073435   0.19368221  0.029887773 
number of iterations: 29342 
    8900    60.818827      237          237            0 2.4868868e-13            0          0.1 0.0090074896   0.19836207   0.02988753 
number of iterations: 29451 
    9000    61.600533      246          246            0 2.5363727e-13            0          0.1 0.0090076387   0.20313506  0.029887281 
number of iterations: 28957 
    9100    62.346988      250          250            0 2.5868433e-13            0          0.1  0.009007775   0.20800301  0.029887054 
number of iterations: 29908 
    9200    63.093775      254          254            0 2.6383182e-13            0          0.1 0.0090079366   0.21296783  0.029886785 
number of iterations: 29760 
    9300    63.849419      265          265            0 2.6908174e-13            0          0.1 0.0090080946   0.21803144  0.029886522 
number of iterations: 29865 
    9400    64.634171      268          268            0 2.7443613e-13            0          0.1 0.0090082557   0.22319581  0.029886254 
number of iterations: 29970 
    9500    65.433729      272          272            0 2.7989706e-13            0          0.1 0.0090084199   0.22846294  0.029885981 
number of iterations: 30076 
    9600    66.219077      279          279            0 2.8546665e-13            0          0.1 0.0090085875   0.23383488  0.029885702 
number of iterations: 30182 
    9700    66.991578      287          287            0 2.9114708e-13            0          0.1 0.0090087584   0.23931371  0.029885417 
number of iterations: 30289 
    9800    67.700196      292          292            0 2.9694054e-13            0          0.1 0.0090089327   0.24490156  0.029885127 
number of iterations: 30482 
    9900     68.43531      298          298            0 3.0284928e-13            0          0.1 0.0090091127    0.2506006  0.029884827 
number of iterations: 30502 
   10000    69.193406      306          306            0 3.0887559e-13            0          0.1  0.009009294   0.25641305  0.029884525 
Loop time of 69.1935 on 8 procs for 10000 steps with 306 atoms

Performance: 124867208.028 tau/day, 144.522 timesteps/s
87.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0089322  | 0.011832   | 0.014099   |   1.5 |  0.02
Neigh   | 0.0082684  | 0.0096904  | 0.011032   |   1.1 |  0.01
Comm    | 0.02948    | 0.045671   | 0.065806   |   5.9 |  0.07
Output  | 13.226     | 13.226     | 13.229     |   0.0 | 19.11
Modify  | 55.821     | 55.825     | 55.828     |   0.0 | 80.68
Other   |            | 0.07565    |            |       |  0.11

Nlocal:    38.25 ave 57 max 12 min
Histogram: 1 0 0 1 1 1 1 0 1 2
Nghost:    6.125 ave 15 max 3 min
Histogram: 4 0 2 1 0 0 0 0 0 1
Neighs:    44.125 ave 74 max 13 min
Histogram: 1 0 1 0 1 2 1 1 0 1

Total # of neighbors = 353
Ave neighs/atom = 1.15359
Neighbor list builds = 123
Dangerous builds = 0
#shell cd ..
#clear
#next reps
#jump SELF
Total wall time: 0:01:09
