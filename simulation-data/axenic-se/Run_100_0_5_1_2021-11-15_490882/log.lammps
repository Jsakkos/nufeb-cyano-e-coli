LAMMPS (20 Nov 2019)
# NUFEB simulation

atom_style	bio
atom_modify	map array sort 1000 5.0e-7
boundary	ff ff ff
newton		off
processors  * * *

comm_modify	vel yes
#variable reps loop 1
read_data_bio atom_100_0_5_1_2021-11-15.in
  orthogonal box = (0 0 0) to (0.0001 0.0001 0.0001)
  2 by 4 by 4 MPI processor grid
  reading atoms ...
  100 atoms
  4 nutrients
#shell mkdir Run_100_0_5_1
#shell cd Run_100_0_5_1
##############Define initial particle distribution##############

lattice sc 1e-6 origin 0 0 0
Lattice spacing in x,y,z = 100 100 100
region reg block 0 1000 0 1000 0 100

group CYANO type 1
100 atoms in group CYANO
group ECW type 2
0 atoms in group ECW

neighbor	5e-7 bin
neigh_modify	delay 0 one 5000

##############Define DEM Variables&Commands##############

pair_style  gran/hooke/history 1.e-4 NULL 1.e-5 NULL 0.0 1
pair_coeff  * *

timestep 10

fix 1 all nve/limit 1e-8
fix fv all viscous 1e-5

fix zw all wall/gran hooke/history 2000 NULL 500.0 NULL 1.5 0 zplane  0.0  0.0001

variable kanc equal 50

variable ke equal 5e+10


##############Define IBm Variables##############

#variables used in fix eps_extract
variable EPSdens equal 30
variable EPSratio equal 1.3

#variables used in fix division
variable divDia1 equal 1.96e-6
variable divDia2 equal 1.04e-6

#variables used in fix kinetics
variable diffT equal 1e-4
variable tol equal 1e-11
variable etaHET equal 0.6
variable layer equal -1

#variables used in fix death
#variable deadDia equal 9e-7


##############Define IBm Commands##############

fix k1 all kinetics 100 5 5 5 v_diffT v_layer niter 1000000
fix kgm all kinetics/growth/monod sucexp 0.05
fix g1 all kinetics/diffusion v_tol
fix d1 CYANO divide 100 v_EPSdens v_divDia1 433593
fix d2 ECW divide 100 v_EPSdens v_divDia2 239363
#fix d2 all death 1 v_deadDia demflag 0


##############Define IBm Computes##############

compute myNtypes all ntypes
compute myMass all biomass
compute myCon all avg_con

##############Simulation exit condition##############
variable co2 equal c_myCon[4]
fix 10 all halt 1000 v_co2 <= 1e-19

variable light equal c_myCon[1]
fix 11 all halt 1000 v_light <= 1e-19

##############Simulation Output##############



dump    du3 all bio 100 ntypes biomass avg_con
dump    traj all bio/hdf5 100 trajectory.h5 id type radius x y z con
thermo_style    custom step cpu atoms c_myNtypes[*] c_myMass[*] c_myCon[*]
thermo		100
thermo_modify	lost ignore


run 8700
Model is defined as a closed system. 
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 5000, page size: 100000
  master list distance cutoff = 2.44e-06
  ghost atom cutoff = 2.44e-06
  binsize = 1.22e-06, bins = 82 82 82
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair gran/hooke/history, perpetual
      attributes: half, newton off, size, history
      pair build: half/size/bin/newtoff
      stencil: half/bin/3d/newtoff
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.856 | 9.319 | 10.91 Mbytes
Step CPU Atoms c_myNtypes[1] c_myNtypes[2] c_myMass[1] c_myMass[2] c_myCon[1] c_myCon[2] c_myCon[3] c_myCon[4] 
       0            0      100          100            0 9.0297278e-14            0          0.1        0.009     3.42e-20       0.0299 
number of iterations: 122046 
     100    1.3150567      100          100            0 9.1928077e-14            0          0.1 0.0090008891 1.233761e-05   0.02989852 
number of iterations: 107407 
     200    2.4278497      100          100            0 9.3588329e-14            0          0.1 0.0090009051 3.1840121e-05  0.029898493 
number of iterations: 95941 
     300     3.431523      101          101            0 9.5278565e-14            0          0.1 0.0090009215 6.1822208e-05  0.029898466 
number of iterations: 85525 
     400    4.3310846      102          102            0 9.6999327e-14            0          0.1 0.0090009381 0.00010795857  0.029898438 
number of iterations: 75644 
     500     5.169538      103          103            0 9.8751167e-14            0          0.1  0.009000955 0.00017918851   0.02989841 
number of iterations: 65996 
     600    5.8807347      106          106            0 1.0053465e-13            0          0.1 0.0090009723 0.00028987548  0.029898381 
number of iterations: 56347 
     700    6.5057479      111          111            0 1.0235033e-13            0          0.1 0.0090009898 0.00046388279  0.029898352 
number of iterations: 46429 
     800    7.0653745      115          115            0 1.0419882e-13            0          0.1 0.0090010077 0.00074337358  0.029898322 
number of iterations: 36644 
     900    7.5095811      117          117            0 1.0608068e-13            0          0.1 0.0090010259 0.0011936117  0.029898292 
number of iterations: 27697 
    1000    7.8619292      117          117            0 1.0799653e-13            0          0.1 0.0090010445 0.0018985988  0.029898261 
number of iterations: 18009 
    1100    8.1199019      118          118            0 1.0994699e-13            0          0.1 0.0090010633 0.0030700398   0.02989823 
number of iterations: 15365 
    1200    8.3445652      119          119            0 1.1193266e-13            0          0.1 0.0090010825 0.0046698573  0.029898198 
number of iterations: 15423 
    1300     8.562688      119          119            0 1.1395421e-13            0          0.1 0.0090011021 0.0065578886  0.029898165 
number of iterations: 15481 
    1400    8.7746518      120          120            0 1.1601226e-13            0          0.1  0.009001122 0.0087761556  0.029898132 
number of iterations: 15149 
    1500    8.9796945      125          125            0 1.1810748e-13            0          0.1 0.0090011418   0.01125803  0.029898099 
number of iterations: 15591 
    1600    9.1880793      125          125            0 1.2024054e-13            0          0.1 0.0090011624  0.013955361  0.029898065 
number of iterations: 15649 
    1700    9.3997094      126          126            0 1.2241212e-13            0          0.1 0.0090011834  0.016860509   0.02989803 
number of iterations: 15707 
    1800    9.6083129      126          126            0 1.2462292e-13            0          0.1 0.0090012048  0.019968961  0.029897994 
number of iterations: 15765 
    1900    9.8153728      128          128            0 1.2687365e-13            0          0.1 0.0090012265  0.023278359  0.029897958 
number of iterations: 15823 
    2000    10.022702      132          132            0 1.2916503e-13            0          0.1 0.0090012487  0.026787798  0.029897921 
number of iterations: 15882 
    2100    10.231182      134          134            0 1.314978e-13            0          0.1 0.0090012712  0.030497759  0.029897883 
number of iterations: 15940 
    2200    10.436014      135          135            0 1.3387269e-13            0          0.1 0.0090012942  0.034409419  0.029897845 
number of iterations: 15998 
    2300    10.640635      137          137            0 1.3629047e-13            0          0.1 0.0090013176  0.038524615  0.029897806 
number of iterations: 16056 
    2400    10.848602      140          140            0 1.3875193e-13            0          0.1 0.0090013414  0.042846073  0.029897767 
number of iterations: 16114 
    2500    11.054145      140          140            0 1.4125783e-13            0          0.1 0.0090013656  0.047376984  0.029897726 
number of iterations: 16172 
    2600    11.258942      141          141            0 1.4380899e-13            0          0.1 0.0090013903  0.052120847  0.029897685 
number of iterations: 16230 
    2700    11.465688      142          142            0 1.4640623e-13            0          0.1 0.0090014154  0.057081791  0.029897643 
number of iterations: 16289 
    2800    11.673928      144          144            0 1.4905038e-13            0          0.1 0.0090014409  0.062263565  0.029897601 
number of iterations: 16355 
    2900    11.900432      147          147            0 1.5174227e-13            0          0.1 0.0090014682  0.067676738  0.029897555 
number of iterations: 16405 
    3000     12.10982      152          152            0 1.5448279e-13            0          0.1 0.0090014951  0.073323673  0.029897511 
number of iterations: 16463 
    3100    12.318477      153          153            0 1.572728e-13            0          0.1 0.0090015221  0.079205746  0.029897466 
number of iterations: 16521 
    3200    12.528016      155          155            0 1.601132e-13            0          0.1 0.0090015496  0.085329004   0.02989742 
number of iterations: 16579 
    3300    12.758869      155          155            0 1.6300489e-13            0          0.1 0.0090015776  0.091698096  0.029897373 
number of iterations: 16637 
    3400    12.965767      157          157            0 1.6594881e-13            0          0.1 0.0090016061  0.098318987  0.029897326 
number of iterations: 16696 
    3500    13.174702      157          157            0 1.689459e-13            0          0.1 0.0090016351   0.10514714  0.029897278 
number of iterations: 16754 
    3600    13.384637      160          160            0 1.7199712e-13            0          0.1 0.0090016646   0.11216272  0.029897228 
number of iterations: 17442 
    3700     13.60124      162          162            0 1.7510345e-13            0          0.1 0.0090016948   0.11936807  0.029897178 
number of iterations: 16882 
    3800    13.813136      165          165            0 1.7826587e-13            0          0.1 0.0090017254   0.12676536  0.029897127 
number of iterations: 16941 
    3900    14.022107      167          167            0 1.8148541e-13            0          0.1 0.0090017566   0.13435782  0.029897075 
number of iterations: 16999 
    4000    14.233326      169          169            0 1.847631e-13            0          0.1 0.0090017883   0.14214732  0.029897022 
number of iterations: 17057 
    4100    14.476849      170          170            0 1.8809998e-13            0          0.1 0.0090018206   0.15013686  0.029896969 
number of iterations: 18029 
    4200    14.700761      175          175            0 1.9149713e-13            0          0.1 0.0090018554   0.15833329  0.029896911 
number of iterations: 17687 
    4300    14.920546      184          184            0 1.9495563e-13            0          0.1 0.0090019015   0.16673544  0.029896834 
number of iterations: 17260 
    4400    15.133921      188          188            0 1.9847659e-13            0          0.1 0.0090019353    0.1753319  0.029896778 
number of iterations: 17317 
    4500    15.353253      193          193            0 2.0206114e-13            0          0.1 0.0090019703   0.18415239  0.029896719 
number of iterations: 17291 
    4600    15.573551      202          202            0 2.0571043e-13            0          0.1 0.0090020058   0.19318806   0.02989666 
number of iterations: 17432 
    4700    15.805351      207          207            0 2.0942563e-13            0          0.1  0.009002042   0.20244137    0.0298966 
number of iterations: 17490 
    4800    16.022493      213          213            0 2.1320792e-13            0          0.1 0.0090020789   0.21191627  0.029896539 
number of iterations: 17548 
    4900    16.238287      217          217            0 2.1705852e-13            0          0.1 0.0090021164   0.22161506  0.029896476 
number of iterations: 17368 
    5000    16.453504      223          223            0 2.2097867e-13            0          0.1 0.0090021535   0.23154158  0.029896414 
number of iterations: 17510 
    5100    16.670083      227          227            0 2.2496962e-13            0          0.1 0.0090021949   0.24177048  0.029896345 
number of iterations: 18515 
    5200    16.898454      230          230            0 2.2903264e-13            0          0.1 0.0090022331   0.25219139  0.029896282 
number of iterations: 17959 
    5300    17.153193      234          234            0 2.3316904e-13            0          0.1  0.009002273   0.26282436  0.029896215 
number of iterations: 17851 
    5400    17.374016      238          238            0 2.3738015e-13            0          0.1  0.009002314   0.27364936  0.029896147 
number of iterations: 17910 
    5500    17.595455      240          240            0 2.4166731e-13            0          0.1 0.0090023558   0.28466987  0.029896077 
number of iterations: 17968 
    5600    17.819612      245          245            0 2.460319e-13            0          0.1 0.0090023987   0.29588941  0.029896006 
number of iterations: 18026 
    5700    18.045741      252          252            0 2.5047532e-13            0          0.1  0.009002442   0.30731159  0.029895934 
number of iterations: 18084 
    5800    18.269768      261          261            0 2.5499898e-13            0          0.1 0.0090024861   0.31894005   0.02989586 
number of iterations: 18142 
    5900    18.493665      265          265            0 2.5960435e-13            0          0.1  0.009002531   0.33077852  0.029895786 
number of iterations: 18247 
    6000    18.719841      270          270            0 2.6429289e-13            0          0.1 0.0090025764   0.34283081   0.02989571 
number of iterations: 18259 
    6100    18.948035      272          272            0 2.690661e-13            0          0.1 0.0090026229   0.35510076  0.029895633 
number of iterations: 18313 
    6200    19.175917      275          275            0 2.7392552e-13            0          0.1 0.0090026692   0.36759231  0.029895556 
number of iterations: 18375 
    6300    19.404553      279          279            0 2.788727e-13            0          0.1 0.0090027175   0.38030946  0.029895475 
number of iterations: 18229 
    6400    19.651231      282          282            0 2.8390923e-13            0          0.1   0.00900276   0.39325628  0.029895404 
number of iterations: 18487 
    6500    19.881755      285          285            0 2.8903672e-13            0          0.1 0.0090028099   0.40643692  0.029895321 
number of iterations: 18546 
    6600    20.113724      286          286            0 2.9425682e-13            0          0.1 0.0090028606   0.41985561  0.029895237 
number of iterations: 18604 
    6700    20.365936      292          292            0 2.9957119e-13            0          0.1  0.009002912   0.43351665  0.029895151 
number of iterations: 18662 
    6800    20.597818      296          296            0 3.0498154e-13            0          0.1 0.0090029646    0.4474244  0.029895064 
number of iterations: 18561 
    6900    20.831622      301          301            0 3.104896e-13            0          0.1 0.0090030187   0.46158335  0.029894974 
number of iterations: 18775 
    7000    21.067894      303          303            0 3.1609715e-13            0          0.1 0.0090030732   0.47599801  0.029894883 
number of iterations: 18833 
    7100    21.301077      305          305            0 3.2180596e-13            0          0.1 0.0090031287     0.490673  0.029894791 
number of iterations: 18891 
    7200    21.535551      311          311            0 3.2761788e-13            0          0.1 0.0090031852   0.50561561  0.029894696 
number of iterations: 18949 
    7300    21.770336      314          314            0 3.3353476e-13            0          0.1  0.009003243   0.52082809    0.0298946 
number of iterations: 18146 
    7400    21.997875      319          319            0 3.395585e-13            0          0.1 0.0090032997   0.53631531  0.029894506 
number of iterations: 19052 
    7500    22.236625      323          323            0 3.4569104e-13            0          0.1 0.0090033593   0.55208223  0.029894407 
number of iterations: 19193 
    7600    22.476528      330          330            0 3.5193433e-13            0          0.1 0.0090034199    0.5681339  0.029894306 
number of iterations: 19170 
    7700    22.715294      338          338            0 3.5829037e-13            0          0.1 0.0090034817   0.58447548  0.029894203 
number of iterations: 19228 
    7800    22.954548      346          346            0 3.6476121e-13            0          0.1 0.0090035446   0.60111219  0.029894098 
number of iterations: 19323 
    7900    23.195726      356          356            0 3.7134891e-13            0          0.1 0.0090036093   0.61804936   0.02989399 
number of iterations: 19083 
    8000     23.44948      362          362            0 3.7805559e-13            0          0.1 0.0090036723   0.63529243  0.029893885 
number of iterations: 19470 
    8100    23.696806      371          371            0 3.8488339e-13            0          0.1 0.0090037422   0.65284691  0.029893769 
number of iterations: 19324 
    8200    23.935217      384          384            0 3.9183451e-13            0          0.1 0.0090038026   0.67071844  0.029893668 
number of iterations: 19513 
    8300    24.176512      387          387            0 3.9891116e-13            0          0.1 0.0090038713   0.68891274  0.029893554 
number of iterations: 19490 
    8400    24.448408      394          394            0 4.0611562e-13            0          0.1 0.0090039438   0.70743563  0.029893433 
number of iterations: 19628 
    8500    24.696358      400          400            0 4.1345019e-13            0          0.1  0.009004015   0.72629306  0.029893315 
number of iterations: 20173 
    8600    24.949645      409          409            0 4.2091723e-13            0          0.1 0.0090040946   0.74549105  0.029893182 
number of iterations: 19753 
    8700    25.195172      414          414            0 4.2851913e-13            0          0.1 0.0090041685   0.76503576  0.029893059 
Loop time of 25.1952 on 32 procs for 8700 steps with 414 atoms

Performance: 298342629.272 tau/day, 345.304 timesteps/s
98.4% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00054315 | 0.0022648  | 0.0061829  |   2.8 |  0.01
Neigh   | 0.0010942  | 0.0019733  | 0.0047859  |   1.8 |  0.01
Comm    | 0.01427    | 0.030602   | 0.047296   |   4.4 |  0.12
Output  | 0.92976    | 0.93024    | 0.93159    |   0.0 |  3.69
Modify  | 24.178     | 24.181     | 24.187     |   0.0 | 95.98
Other   |            | 0.0487     |            |       |  0.19

Nlocal:    12.9375 ave 47 max 1 min
Histogram: 7 10 5 3 4 0 1 0 1 1
Nghost:    4.75 ave 12 max 0 min
Histogram: 5 7 0 3 5 6 2 1 1 2
Neighs:    12.8438 ave 50 max 1 min
Histogram: 8 10 4 5 2 0 1 1 0 1

Total # of neighbors = 411
Ave neighs/atom = 0.992754
Neighbor list builds = 103
Dangerous builds = 0
#shell cd ..
#clear
#next reps
#jump SELF
Total wall time: 0:00:25
