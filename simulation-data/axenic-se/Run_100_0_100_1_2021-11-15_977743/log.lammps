LAMMPS (20 Nov 2019)
# NUFEB simulation

atom_style	bio
atom_modify	map array sort 1000 5.0e-7
boundary	ff ff ff
newton		off
processors  * * *

comm_modify	vel yes
#variable reps loop 1
read_data_bio atom_100_0_100_1_2021-11-15.in
  orthogonal box = (0 0 0) to (0.0001 0.0001 0.0001)
  2 by 4 by 4 MPI processor grid
  reading atoms ...
  100 atoms
  4 nutrients
#shell mkdir Run_100_0_100_1
#shell cd Run_100_0_100_1
##############Define initial particle distribution##############

lattice sc 1e-6 origin 0 0 0
Lattice spacing in x,y,z = 100 100 100
region reg block 0 1000 0 1000 0 100

group CYANO type 1
100 atoms in group CYANO
group ECW type 2
0 atoms in group ECW

neighbor	5e-7 bin
neigh_modify	delay 0 one 5000

##############Define DEM Variables&Commands##############

pair_style  gran/hooke/history 1.e-4 NULL 1.e-5 NULL 0.0 1
pair_coeff  * *

timestep 10

fix 1 all nve/limit 1e-8
fix fv all viscous 1e-5

fix zw all wall/gran hooke/history 2000 NULL 500.0 NULL 1.5 0 zplane  0.0  0.0001

variable kanc equal 50

variable ke equal 5e+10


##############Define IBm Variables##############

#variables used in fix eps_extract
variable EPSdens equal 30
variable EPSratio equal 1.3

#variables used in fix division
variable divDia1 equal 1.96e-6
variable divDia2 equal 1.04e-6

#variables used in fix kinetics
variable diffT equal 1e-4
variable tol equal 1e-11
variable etaHET equal 0.6
variable layer equal -1

#variables used in fix death
#variable deadDia equal 9e-7


##############Define IBm Commands##############

fix k1 all kinetics 100 5 5 5 v_diffT v_layer niter 1000000
fix kgm all kinetics/growth/monod sucexp 1.0
fix g1 all kinetics/diffusion v_tol
fix d1 CYANO divide 100 v_EPSdens v_divDia1 827605
fix d2 ECW divide 100 v_EPSdens v_divDia2 535264
#fix d2 all death 1 v_deadDia demflag 0


##############Define IBm Computes##############

compute myNtypes all ntypes
compute myMass all biomass
compute myCon all avg_con

##############Simulation exit condition##############
variable co2 equal c_myCon[4]
fix 10 all halt 1000 v_co2 <= 1e-19

variable light equal c_myCon[1]
fix 11 all halt 1000 v_light <= 1e-19

##############Simulation Output##############



dump    du3 all bio 100 ntypes biomass avg_con
dump    traj all bio/hdf5 100 trajectory.h5 id type radius x y z con
thermo_style    custom step cpu atoms c_myNtypes[*] c_myMass[*] c_myCon[*]
thermo		100
thermo_modify	lost ignore


run 8700
Model is defined as a closed system. 
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 5000, page size: 100000
  master list distance cutoff = 2.44e-06
  ghost atom cutoff = 2.44e-06
  binsize = 1.22e-06, bins = 82 82 82
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair gran/hooke/history, perpetual
      attributes: half, newton off, size, history
      pair build: half/size/bin/newtoff
      stencil: half/bin/3d/newtoff
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.856 | 8.88 | 10.91 Mbytes
Step CPU Atoms c_myNtypes[1] c_myNtypes[2] c_myMass[1] c_myMass[2] c_myCon[1] c_myCon[2] c_myCon[3] c_myCon[4] 
       0            0      100          100            0 9.1577489e-14            0          0.1        0.009     3.42e-20       0.0299 
number of iterations: 123095 
     100    1.3355754      100          100            0 9.3122261e-14            0          0.1 0.0090011994 1.686966e-05  0.029898003 
number of iterations: 109036 
     200    2.4734655      100          100            0 9.4693091e-14            0          0.1 0.0090012197 4.2727739e-05  0.029897969 
number of iterations: 97436 
     300    3.5138401      101          101            0 9.6290419e-14            0          0.1 0.0090012402 8.2260809e-05  0.029897935 
number of iterations: 87020 
     400    4.4478249      104          104            0 9.7914691e-14            0          0.1 0.0090012612 0.00014265754    0.0298979 
number of iterations: 77229 
     500    5.2900414      104          104            0 9.9566362e-14            0          0.1 0.0090012824 0.00023504414  0.029897865 
number of iterations: 67752 
     600    6.0375536      106          106            0 1.0124589e-13            0          0.1 0.0090013041 0.00037690256  0.029897829 
number of iterations: 58354 
     700    6.7246886      106          106            0 1.0295376e-13            0          0.1 0.0090013261 0.00059656483  0.029897792 
number of iterations: 48771 
     800    7.3235437      110          110            0 1.0469043e-13            0          0.1 0.0090013484 0.00094278792  0.029897755 
number of iterations: 38467 
     900    7.7943974      112          112            0 1.064564e-13            0          0.1 0.0090013712 0.0015125345  0.029897717 
number of iterations: 25627 
    1000    8.1413964      112          112            0 1.0825215e-13            0          0.1 0.0090013943 0.0025906546  0.029897678 
number of iterations: 17164 
    1100    8.3990086      114          114            0 1.100782e-13            0          0.1 0.0090014173  0.004285876   0.02989764 
number of iterations: 16723 
    1200    8.6424157      116          116            0 1.1193505e-13            0          0.1 0.0090014412 0.0063985367    0.0298976 
number of iterations: 16777 
    1300    8.8803818      117          117            0 1.1382323e-13            0          0.1 0.0090014655 0.0088976903   0.02989756 
number of iterations: 16592 
    1400    9.1127161      119          119            0 1.1574325e-13            0          0.1 0.0090014837  0.011740705   0.02989753 
number of iterations: 16881 
    1500    9.3433227      122          122            0 1.1769566e-13            0          0.1 0.0090015087  0.014920833  0.029897488 
number of iterations: 16935 
    1600    9.5728599      125          125            0 1.1968101e-13            0          0.1 0.0090015342  0.018423238  0.029897446 
number of iterations: 17033 
    1700    9.8022229      128          128            0 1.2169984e-13            0          0.1 0.0090015659  0.022203227  0.029897393 
number of iterations: 17043 
    1800    10.028448      129          129            0 1.2375273e-13            0          0.1 0.0090015924   0.02628917  0.029897349 
number of iterations: 17839 
    1900    10.263239      132          132            0 1.2584025e-13            0          0.1 0.0090016183  0.030665376  0.029897305 
number of iterations: 17165 
    2000    10.490856      134          134            0 1.2796298e-13            0          0.1 0.0090016456  0.035340694   0.02989726 
number of iterations: 17219 
    2100    10.718101      135          135            0 1.3012152e-13            0          0.1 0.0090016734   0.04031448  0.029897214 
number of iterations: 17273 
    2200    10.943314      136          136            0 1.3231647e-13            0          0.1 0.0090017016  0.045586905  0.029897167 
number of iterations: 17327 
    2300    11.170394      137          137            0 1.3454845e-13            0          0.1 0.0090017303   0.05115961  0.029897119 
number of iterations: 17381 
    2400     11.39499      140          140            0 1.3681808e-13            0          0.1 0.0090017595  0.057034686   0.02989707 
number of iterations: 17534 
    2500    11.628093      143          143            0 1.3912599e-13            0          0.1 0.0090017925  0.063197319  0.029897015 
number of iterations: 17490 
    2600    11.852544      144          144            0 1.4147283e-13            0          0.1 0.0090018227  0.069646672  0.029896965 
number of iterations: 17544 
    2700     12.07624      147          147            0 1.4385926e-13            0          0.1 0.0090018535  0.076356345  0.029896914 
number of iterations: 17598 
    2800    12.304579      149          149            0 1.4628594e-13            0          0.1 0.0090018847  0.083329331  0.029896862 
number of iterations: 17652 
    2900    12.534376      149          149            0 1.4875356e-13            0          0.1 0.0090019165  0.090569507  0.029896809 
number of iterations: 18003 
    3000    12.765925      150          150            0 1.5126281e-13            0          0.1 0.0090019505  0.098081135  0.029896752 
number of iterations: 17796 
    3100    12.991612      154          154            0 1.5381438e-13            0          0.1  0.009001984   0.10586766  0.029896696 
number of iterations: 17819 
    3200    13.218497      155          155            0 1.5640899e-13            0          0.1 0.0090020175   0.11393198  0.029896641 
number of iterations: 18328 
    3300     13.45157      157          157            0 1.5904737e-13            0          0.1 0.0090020514   0.12227878  0.029896584 
number of iterations: 17935 
    3400    13.678856      157          157            0 1.6173026e-13            0          0.1  0.009002086   0.13091346  0.029896527 
number of iterations: 18168 
    3500     13.90892      160          160            0 1.644584e-13            0          0.1 0.0090021176   0.13983001  0.029896474 
number of iterations: 18046 
    3600    14.137452      161          161            0 1.6723256e-13            0          0.1 0.0090021533   0.14904267  0.029896415 
number of iterations: 18100 
    3700    14.366245      162          162            0 1.7005352e-13            0          0.1 0.0090021897   0.15855753  0.029896354 
number of iterations: 18154 
    3800    14.595485      164          164            0 1.7292206e-13            0          0.1 0.0090022266   0.16838037  0.029896293 
number of iterations: 18208 
    3900    14.824816      165          165            0 1.7583899e-13            0          0.1 0.0090022641   0.17851668   0.02989623 
number of iterations: 18262 
    4000    15.058097      167          167            0 1.7880512e-13            0          0.1 0.0090023023   0.18897159  0.029896166 
number of iterations: 18316 
    4100    15.288548      169          169            0 1.8182129e-13            0          0.1 0.0090023412   0.19974986  0.029896102 
number of iterations: 18370 
    4200    15.519826      169          169            0 1.8488833e-13            0          0.1 0.0090023807   0.21085959  0.029896036 
number of iterations: 18424 
    4300    15.748537      169          169            0 1.8800712e-13            0          0.1 0.0090024208   0.22230497  0.029895969 
number of iterations: 18477 
    4400    15.978827      173          173            0 1.9117851e-13            0          0.1 0.0090024617   0.23409382  0.029895901 
number of iterations: 18531 
    4500     16.21425      177          177            0 1.9440339e-13            0          0.1 0.0090025032   0.24623179  0.029895832 
number of iterations: 18585 
    4600     16.44522      181          181            0 1.9768268e-13            0          0.1 0.0090025454   0.25872424  0.029895762 
number of iterations: 19990 
    4700    16.723181      186          186            0 2.0101728e-13            0          0.1 0.0090025959   0.27158229  0.029895678 
number of iterations: 18721 
    4800    16.983724      193          193            0 2.0440814e-13            0          0.1 0.0090026397   0.28480913  0.029895605 
number of iterations: 18775 
    4900    17.232773      198          198            0 2.0785619e-13            0          0.1 0.0090026843   0.29841193  0.029895531 
number of iterations: 18829 
    5000    17.472527      204          204            0 2.113624e-13            0          0.1 0.0090027295   0.31239769  0.029895455 
number of iterations: 18883 
    5100    17.707232      206          206            0 2.1492776e-13            0          0.1 0.0090027751   0.32675457  0.029895379 
number of iterations: 19044 
    5200    17.943599      211          211            0 2.1855326e-13            0          0.1 0.0090028277   0.34135365  0.029895292 
number of iterations: 18882 
    5300     18.17842      218          218            0 2.2223992e-13            0          0.1 0.0090028695   0.35619898  0.029895222 
number of iterations: 19044 
    5400    18.414463      224          224            0 2.2598876e-13            0          0.1 0.0090029171   0.37129471  0.029895143 
number of iterations: 19098 
    5500    18.652627      225          225            0 2.2980085e-13            0          0.1 0.0090029663   0.38664509  0.029895061 
number of iterations: 19152 
    5600    18.891846      229          229            0 2.3367723e-13            0          0.1 0.0090030163    0.4022544  0.029894978 
number of iterations: 19206 
    5700    19.134849      237          237            0 2.3761901e-13            0          0.1 0.0090030672   0.41812702  0.029894893 
number of iterations: 19260 
    5800    19.373363      239          239            0 2.4162727e-13            0          0.1 0.0090031189   0.43426739  0.029894807 
number of iterations: 19263 
    5900    19.614243      250          250            0 2.4570315e-13            0          0.1 0.0090031706   0.45068002  0.029894721 
number of iterations: 19367 
    6000     19.85957      254          254            0 2.4984779e-13            0          0.1 0.0090032241   0.46736951  0.029894632 
number of iterations: 19410 
    6100    20.101135      261          261            0 2.5406233e-13            0          0.1  0.009003276   0.48434053  0.029894545 
number of iterations: 19475 
    6200    20.346232      267          267            0 2.5834797e-13            0          0.1 0.0090033313   0.50159783  0.029894453 
number of iterations: 19553 
    6300     20.59036      272          272            0 2.6270591e-13            0          0.1 0.0090033883   0.51914622  0.029894358 
number of iterations: 19583 
    6400    20.834561      278          278            0 2.6713735e-13            0          0.1 0.0090034454   0.53699063  0.029894263 
number of iterations: 19523 
    6500    21.075445      284          284            0 2.7164354e-13            0          0.1 0.0090034982   0.55513601  0.029894175 
number of iterations: 20442 
    6600    21.328291      291          291            0 2.7622575e-13            0          0.1  0.009003568   0.57358747  0.029894059 
number of iterations: 19936 
    6700     21.57375      295          295            0 2.8088525e-13            0          0.1 0.0090036371   0.59235019  0.029893944 
number of iterations: 19814 
    6800     21.81963      296          296            0 2.8562335e-13            0          0.1 0.0090036985    0.6114294  0.029893842 
number of iterations: 19868 
    6900    22.065718      297          297            0 2.9044138e-13            0          0.1 0.0090037609   0.63083046  0.029893738 
number of iterations: 19921 
    7000    22.314306      297          297            0 2.9534068e-13            0          0.1 0.0090038243   0.65055877  0.029893632 
number of iterations: 20578 
    7100    22.572195      299          299            0 3.0032262e-13            0          0.1  0.009003894   0.67061989  0.029893516 
number of iterations: 20040 
    7200    22.820976      301          301            0 3.053886e-13            0          0.1 0.0090039597    0.6910194  0.029893407 
number of iterations: 20094 
    7300    23.069397      301          301            0 3.1054003e-13            0          0.1 0.0090040265   0.71176302  0.029893296 
number of iterations: 20148 
    7400     23.31876      302          302            0 3.1577836e-13            0          0.1 0.0090040944   0.73285656  0.029893182 
number of iterations: 20202 
    7500    23.568552      309          309            0 3.2110505e-13            0          0.1 0.0090041635   0.75430591  0.029893067 
number of iterations: 20256 
    7600    23.818647      312          312            0 3.265216e-13            0          0.1 0.0090042337   0.77611708   0.02989295 
number of iterations: 20310 
    7700    24.070478      316          316            0 3.3202951e-13            0          0.1 0.0090043052   0.79829616  0.029892832 
number of iterations: 20364 
    7800    24.321101      321          321            0 3.3763033e-13            0          0.1 0.0090043778   0.82084938  0.029892711 
number of iterations: 20418 
    7900    24.573676      325          325            0 3.4332564e-13            0          0.1 0.0090044521   0.84378304  0.029892587 
number of iterations: 20412 
    8000    24.827276      326          326            0 3.4911701e-13            0          0.1 0.0090045268   0.86710354  0.029892463 
number of iterations: 20524 
    8100    25.081163      330          330            0 3.5500607e-13            0          0.1 0.0090046031   0.89081743  0.029892335 
number of iterations: 20578 
    8200    25.336442      336          336            0 3.6099447e-13            0          0.1 0.0090046808   0.91493133  0.029892206 
number of iterations: 20632 
    8300    25.590964      343          343            0 3.6708389e-13            0          0.1 0.0090047598     0.939452  0.029892075 
number of iterations: 20665 
    8400    25.847891      351          351            0 3.7327603e-13            0          0.1 0.0090048375   0.96438631  0.029891945 
number of iterations: 20740 
    8500    26.106428      359          359            0 3.7957261e-13            0          0.1 0.0090049191   0.98974122  0.029891809 
number of iterations: 20794 
    8600    26.364528      364          364            0 3.8597541e-13            0          0.1  0.009005002    1.0155238  0.029891671 
number of iterations: 20848 
    8700    26.656768      371          371            0 3.9248622e-13            0          0.1 0.0090050864    1.0417414  0.029891531 
Loop time of 26.6568 on 32 procs for 8700 steps with 371 atoms

Performance: 281984377.132 tau/day, 326.371 timesteps/s
98.7% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00041082 | 0.0021862  | 0.0052315  |   3.0 |  0.01
Neigh   | 0.00099182 | 0.0018121  | 0.0043019  |   1.7 |  0.01
Comm    | 0.013523   | 0.033605   | 0.052983   |   5.9 |  0.13
Output  | 0.88731    | 0.88775    | 0.88917    |   0.0 |  3.33
Modify  | 25.675     | 25.681     | 25.685     |   0.0 | 96.34
Other   |            | 0.05079    |            |       |  0.19

Nlocal:    11.5938 ave 34 max 0 min
Histogram: 8 5 7 1 3 1 0 3 1 3
Nghost:    5.25 ave 11 max 0 min
Histogram: 5 2 3 4 3 3 2 6 0 4
Neighs:    10.6875 ave 35 max 0 min
Histogram: 7 10 3 4 1 1 1 1 1 3

Total # of neighbors = 342
Ave neighs/atom = 0.921833
Neighbor list builds = 95
Dangerous builds = 0
#shell cd ..
#clear
#next reps
#jump SELF
Total wall time: 0:00:26
