LAMMPS (20 Nov 2019)
# NUFEB simulation

atom_style	bio
atom_modify	map array sort 1000 5.0e-7
boundary	ff ff ff
newton		off
processors  * * *

comm_modify	vel yes
#variable reps loop 1
read_data_bio atom_100_0_0_1_2021-11-15.in
  orthogonal box = (0 0 0) to (0.0001 0.0001 0.0001)
  2 by 4 by 4 MPI processor grid
  reading atoms ...
  100 atoms
  4 nutrients
#shell mkdir Run_100_0_0_1
#shell cd Run_100_0_0_1
##############Define initial particle distribution##############

lattice sc 1e-6 origin 0 0 0
Lattice spacing in x,y,z = 100 100 100
region reg block 0 1000 0 1000 0 100

group CYANO type 1
100 atoms in group CYANO
group ECW type 2
0 atoms in group ECW

neighbor	5e-7 bin
neigh_modify	delay 0 one 5000

##############Define DEM Variables&Commands##############

pair_style  gran/hooke/history 1.e-4 NULL 1.e-5 NULL 0.0 1
pair_coeff  * *

timestep 10

fix 1 all nve/limit 1e-8
fix fv all viscous 1e-5

fix zw all wall/gran hooke/history 2000 NULL 500.0 NULL 1.5 0 zplane  0.0  0.0001

variable kanc equal 50

variable ke equal 5e+10


##############Define IBm Variables##############

#variables used in fix eps_extract
variable EPSdens equal 30
variable EPSratio equal 1.3

#variables used in fix division
variable divDia1 equal 1.96e-6
variable divDia2 equal 1.04e-6

#variables used in fix kinetics
variable diffT equal 1e-4
variable tol equal 1e-11
variable etaHET equal 0.6
variable layer equal -1

#variables used in fix death
#variable deadDia equal 9e-7


##############Define IBm Commands##############

fix k1 all kinetics 100 5 5 5 v_diffT v_layer niter 1000000
fix kgm all kinetics/growth/monod sucexp 0.0
fix g1 all kinetics/diffusion v_tol
fix d1 CYANO divide 100 v_EPSdens v_divDia1 480940
fix d2 ECW divide 100 v_EPSdens v_divDia2 990391
#fix d2 all death 1 v_deadDia demflag 0


##############Define IBm Computes##############

compute myNtypes all ntypes
compute myMass all biomass
compute myCon all avg_con

##############Simulation exit condition##############
variable co2 equal c_myCon[4]
fix 10 all halt 1000 v_co2 <= 1e-19

variable light equal c_myCon[1]
fix 11 all halt 1000 v_light <= 1e-19

##############Simulation Output##############



dump    du3 all bio 100 ntypes biomass avg_con
dump    traj all bio/hdf5 100 trajectory.h5 id type radius x y z con
thermo_style    custom step cpu atoms c_myNtypes[*] c_myMass[*] c_myCon[*]
thermo		100
thermo_modify	lost ignore


run 8700
Model is defined as a closed system. 
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 5000, page size: 100000
  master list distance cutoff = 2.44e-06
  ghost atom cutoff = 2.44e-06
  binsize = 1.22e-06, bins = 82 82 82
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair gran/hooke/history, perpetual
      attributes: half, newton off, size, history
      pair build: half/size/bin/newtoff
      stencil: half/bin/3d/newtoff
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.856 | 9.481 | 10.91 Mbytes
Step CPU Atoms c_myNtypes[1] c_myNtypes[2] c_myMass[1] c_myMass[2] c_myCon[1] c_myCon[2] c_myCon[3] c_myCon[4] 
       0            0      100          100            0 9.3226246e-14            0          0.1        0.009     3.42e-20       0.0299 
number of iterations: 41112 
     100   0.52394057      100          100            0 9.5045205e-14            0          0.1 0.0090002872 1.4663331e-20  0.029899522 
number of iterations: 34955 
     200   0.91971674      100          100            0 9.6899654e-14            0          0.1 0.0090002928 1.0777437e-20  0.029899513 
number of iterations: 27142 
     300    1.2396199      102          102            0 9.8790285e-14            0          0.1 0.0090002985 9.9744278e-21  0.029899503 
number of iterations: 12116 
     400    1.4195085      105          105            0 1.0071781e-13            0          0.1 0.0090003043 1.0439117e-20  0.029899493 
number of iterations: 24576 
     500     1.715195      105          105            0 1.0268293e-13            0          0.1 0.0090003102 9.889896e-21  0.029899484 
number of iterations: 18317 
     600    1.9529804      111          111            0 1.046864e-13            0          0.1 0.0090003163 1.024295e-20  0.029899473 
number of iterations: 21900 
     700    2.2273225      114          114            0 1.0672896e-13            0          0.1 0.0090003225 9.8271861e-21  0.029899463 
number of iterations: 20386 
     800    2.4846475      115          115            0 1.0881138e-13            0          0.1 0.0090003288 1.0201817e-20  0.029899453 
number of iterations: 21058 
     900    2.7490179      117          117            0 1.1093442e-13            0          0.1 0.0090003352 9.810012e-21  0.029899442 
number of iterations: 20820 
    1000    3.0127617      120          120            0 1.1309889e-13            0          0.1 0.0090003417 1.0193175e-20  0.029899431 
number of iterations: 20859 
    1100    3.2839588      123          123            0 1.1530559e-13            0          0.1 0.0090003484 9.8060368e-21   0.02989942 
number of iterations: 20914 
    1200    3.5501385      125          125            0 1.1755534e-13            0          0.1 0.0090003552 1.0191326e-20  0.029899409 
number of iterations: 20816 
    1300    3.8116692      127          127            0 1.1984899e-13            0          0.1 0.0090003617 9.8052136e-21  0.029899398 
number of iterations: 20934 
    1400    4.1037081      128          128            0 1.2218739e-13            0          0.1 0.0090003687 1.0190899e-20  0.029899386 
number of iterations: 20805 
    1500    4.3749069      128          128            0 1.2457142e-13            0          0.1 0.0090003759 9.8049589e-21  0.029899374 
number of iterations: 20940 
    1600    4.6456151      133          133            0 1.2700196e-13            0          0.1  0.009000385 1.0185403e-20  0.029899359 
number of iterations: 20673 
    1700    4.9088678      135          135            0 1.2947992e-13            0          0.1 0.0090003925 9.8080166e-21  0.029899347 
number of iterations: 20867 
    1800    5.1750793      136          136            0 1.3200624e-13            0          0.1 0.0090004001 1.0186833e-20  0.029899334 
number of iterations: 20708 
    1900     5.440593      138          138            0 1.3458184e-13            0          0.1 0.0090004079 9.808683e-21  0.029899321 
number of iterations: 20852 
    2000    5.7072355      140          140            0 1.372077e-13            0          0.1 0.0090004159 1.0187084e-20  0.029899308 
number of iterations: 20714 
    2100    5.9837329      142          142            0 1.3988479e-13            0          0.1 0.0090004263 9.8087929e-21   0.02989929 
number of iterations: 20849 
    2200    6.2520566      143          143            0 1.4261411e-13            0          0.1 0.0090004346 1.0187157e-20  0.029899276 
number of iterations: 20715 
    2300    6.5200258      145          145            0 1.4539669e-13            0          0.1 0.0090004431 9.8087798e-21  0.029899262 
number of iterations: 20849 
    2400     6.837705      146          146            0 1.4823356e-13            0          0.1 0.0090004517 1.0187169e-20  0.029899248 
number of iterations: 20716 
    2500    7.1023168      147          147            0 1.5112578e-13            0          0.1 0.0090004605 9.8088277e-21  0.029899233 
number of iterations: 20848 
    2600    7.3691258      151          151            0 1.5407443e-13            0          0.1 0.0090004695 1.0187183e-20  0.029899218 
number of iterations: 20716 
    2700    7.6422103      152          152            0 1.5708061e-13            0          0.1 0.0090004787 9.8088142e-21  0.029899203 
number of iterations: 20848 
    2800    7.9088768      154          154            0 1.6014544e-13            0          0.1 0.0090004881 1.0187196e-20  0.029899187 
number of iterations: 20716 
    2900    8.1754696      155          155            0 1.6327008e-13            0          0.1 0.0090004976 9.8088008e-21  0.029899171 
number of iterations: 20849 
    3000    8.4461549      157          157            0 1.6645568e-13            0          0.1 0.0090005073 1.0187149e-20  0.029899155 
number of iterations: 20715 
    3100     8.713151      159          159            0 1.6970343e-13            0          0.1 0.0090005172 9.8087876e-21  0.029899139 
number of iterations: 20849 
    3200    8.9829033      160          160            0 1.7301456e-13            0          0.1 0.0090005273 1.0187162e-20  0.029899122 
number of iterations: 20715 
    3300    9.2526613      161          161            0 1.7639028e-13            0          0.1 0.0090005376 9.8087745e-21  0.029899105 
number of iterations: 20849 
    3400    9.5234111      165          165            0 1.7983187e-13            0          0.1 0.0090005481 1.0187175e-20  0.029899087 
number of iterations: 20716 
    3500     9.794556      170          170            0 1.8334061e-13            0          0.1 0.0090005588 9.8088224e-21   0.02989907 
number of iterations: 20848 
    3600    10.065593      176          176            0 1.8691781e-13            0          0.1 0.0090005704 1.0164167e-20   0.02989905 
number of iterations: 20119 
    3700    10.330405      180          180            0 1.9056481e-13            0          0.1 0.0090005816 9.821729e-21  0.029899032 
number of iterations: 20528 
    3800    10.598996      190          190            0 1.9428296e-13            0          0.1 0.0090005929 1.0169839e-20  0.029899013 
number of iterations: 20274 
    3900    10.867043      193          193            0 1.9807366e-13            0          0.1 0.0090006045 9.8244544e-21  0.029898994 
number of iterations: 20458 
    4000    11.136397      199          199            0 2.0193832e-13            0          0.1 0.0090006162 1.0171055e-20  0.029898974 
number of iterations: 20306 
    4100    11.402905      201          201            0 2.0587839e-13            0          0.1 0.0090006271 9.8225238e-21  0.029898956 
number of iterations: 20508 
    4200    11.677329      206          206            0 2.0989533e-13            0          0.1 0.0090006393 1.017269e-20  0.029898936 
number of iterations: 20349 
    4300    11.946212      209          209            0 2.1399064e-13            0          0.1 0.0090006525 9.8322609e-21  0.029898914 
number of iterations: 20249 
    4400    12.212026      212          212            0 2.1816586e-13            0          0.1 0.0090006652 1.016814e-20  0.029898892 
number of iterations: 20228 
    4500    12.480295      215          215            0 2.2242255e-13            0          0.1 0.0090006782 9.8303425e-21  0.029898871 
number of iterations: 20301 
    4600    12.750319      220          220            0 2.2676229e-13            0          0.1 0.0090006914 1.0167305e-20  0.029898849 
number of iterations: 20205 
    4700    13.021436      227          227            0 2.311867e-13            0          0.1 0.0090007062 9.8299623e-21  0.029898824 
number of iterations: 20312 
    4800    13.289677      234          234            0 2.3569743e-13            0          0.1   0.00900072  1.01671e-20  0.029898801 
number of iterations: 20200 
    4900    13.559732      241          241            0 2.4029618e-13            0          0.1  0.009000734 9.8299038e-21  0.029898778 
number of iterations: 20313 
    5000    13.829151      247          247            0 2.4498465e-13            0          0.1 0.0090007483 1.0167105e-20  0.029898754 
number of iterations: 20200 
    5100    14.129353      252          252            0 2.497646e-13            0          0.1 0.0090007629 9.8298988e-21   0.02989873 
number of iterations: 20313 
    5200    14.404056      257          257            0 2.5463782e-13            0          0.1 0.0090007761 1.016711e-20  0.029898708 
number of iterations: 20200 
    5300    14.679598      264          264            0 2.5960611e-13            0          0.1 0.0090007913 9.8298938e-21  0.029898683 
number of iterations: 20313 
    5400    14.951488      268          268            0 2.6467135e-13            0          0.1 0.0090008067 1.0167115e-20  0.029898657 
number of iterations: 20200 
    5500    15.222435      274          274            0 2.6983541e-13            0          0.1  0.009000823 9.8298888e-21   0.02989863 
number of iterations: 20314 
    5600    15.494681      278          278            0 2.7510023e-13            0          0.1  0.009000839 1.0167067e-20  0.029898603 
number of iterations: 20199 
    5700    15.766933      280          280            0 2.8046777e-13            0          0.1 0.0090008554 9.829884e-21  0.029898576 
number of iterations: 20314 
    5800    16.039048      283          283            0 2.8594004e-13            0          0.1 0.0090008722 1.0167072e-20  0.029898548 
number of iterations: 20199 
    5900    16.309048      286          286            0 2.9151908e-13            0          0.1 0.0090008892 9.8298791e-21  0.029898519 
number of iterations: 20314 
    6000     16.60959      291          291            0 2.9720698e-13            0          0.1 0.0090009066 1.0167076e-20  0.029898491 
number of iterations: 20199 
    6100    16.882994      297          297            0 3.0300585e-13            0          0.1 0.0090009243 9.8298743e-21  0.029898461 
number of iterations: 20314 
    6200    17.156574      299          299            0 3.0891787e-13            0          0.1 0.0090009423 1.0167081e-20  0.029898431 
number of iterations: 20199 
    6300    17.429963      306          306            0 3.1494523e-13            0          0.1 0.0090009607 9.8298695e-21    0.0298984 
number of iterations: 20314 
    6400    17.705009      310          310            0 3.210902e-13            0          0.1 0.0090009794 1.0167086e-20  0.029898369 
number of iterations: 20199 
    6500    17.985481      316          316            0 3.2735506e-13            0          0.1 0.0090009989 9.8298647e-21  0.029898337 
number of iterations: 20314 
    6600    18.259373      321          321            0 3.3374216e-13            0          0.1 0.0090010177 1.0167091e-20  0.029898305 
number of iterations: 20199 
    6700    18.531685      326          326            0 3.4025388e-13            0          0.1 0.0090010375 9.8298599e-21  0.029898273 
number of iterations: 20314 
    6800    18.807499      332          332            0 3.4689265e-13            0          0.1 0.0090010579 1.0167095e-20  0.029898239 
number of iterations: 20199 
    6900    19.104248      337          337            0 3.5366095e-13            0          0.1 0.0090010785 9.8298551e-21  0.029898204 
number of iterations: 20315 
    7000    19.383318      342          342            0 3.6056131e-13            0          0.1 0.0090010996 1.0167047e-20  0.029898169 
number of iterations: 20198 
    7100    19.660149      350          350            0 3.675963e-13            0          0.1  0.009001121 9.8298505e-21  0.029898133 
number of iterations: 20315 
    7200    19.957752      359          359            0 3.7476856e-13            0          0.1 0.0090011426 1.0167052e-20  0.029898098 
number of iterations: 20198 
    7300    20.234001      366          366            0 3.8208075e-13            0          0.1  0.009001164 9.8298459e-21  0.029898062 
number of iterations: 20315 
    7400    20.513685      375          375            0 3.8953561e-13            0          0.1 0.0090011867 1.0167056e-20  0.029898024 
number of iterations: 20198 
    7500    20.792153      383          383            0 3.9713593e-13            0          0.1 0.0090012099 9.8298413e-21  0.029897986 
number of iterations: 20315 
    7600    21.070339      390          390            0 4.0488454e-13            0          0.1 0.0090012335 1.0167061e-20  0.029897946 
number of iterations: 20199 
    7700    21.347438      403          403            0 4.1278433e-13            0          0.1 0.0090012575  9.82989e-21  0.029897906 
number of iterations: 20314 
    7800    21.625749      413          413            0 4.2083826e-13            0          0.1 0.0090012812 1.0167226e-20  0.029897867 
number of iterations: 20203 
    7900    21.902802      426          426            0 4.2904933e-13            0          0.1 0.0090013062 9.8297974e-21  0.029897825 
number of iterations: 20316 
    8000    22.182747      435          435            0 4.374206e-13            0          0.1 0.0090013317 1.0167212e-20  0.029897783 
number of iterations: 20203 
    8100    22.470824      442          442            0 4.4595522e-13            0          0.1 0.0090013577 9.8298115e-21  0.029897739 
number of iterations: 20316 
    8200     22.77417      451          451            0 4.5465635e-13            0          0.1 0.0090013859 1.0167198e-20  0.029897692 
number of iterations: 20202 
    8300    23.051176      462          462            0 4.6352725e-13            0          0.1 0.0090014114 9.8297724e-21   0.02989765 
number of iterations: 20317 
    8400    23.331604      472          472            0 4.7257123e-13            0          0.1 0.0090014389 1.0167184e-20  0.029897604 
number of iterations: 20202 
    8500    23.612586      483          483            0 4.8179167e-13            0          0.1 0.0090014672 9.8297867e-21  0.029897557 
number of iterations: 20316 
    8600    23.892647      488          488            0 4.9119202e-13            0          0.1 0.0090014965 1.0167223e-20  0.029897508 
number of iterations: 20203 
    8700    24.219606      497          497            0 5.0077578e-13            0          0.1 0.0090015257 9.8298008e-21   0.02989746 
Loop time of 24.2196 on 32 procs for 8700 steps with 497 atoms

Performance: 310359874.217 tau/day, 359.213 timesteps/s
98.5% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00042146 | 0.0025156  | 0.0056167  |   2.7 |  0.01
Neigh   | 0.0011236  | 0.0020721  | 0.004817   |   1.8 |  0.01
Comm    | 0.015704   | 0.032205   | 0.050011   |   4.7 |  0.13
Output  | 0.86807    | 0.86845    | 0.86929    |   0.0 |  3.59
Modify  | 23.261     | 23.266     | 23.27      |   0.1 | 96.06
Other   |            | 0.04836    |            |       |  0.20

Nlocal:    15.5312 ave 43 max 0 min
Histogram: 6 4 4 7 3 4 0 1 0 3
Nghost:    5.96875 ave 14 max 0 min
Histogram: 2 2 9 4 3 3 3 4 0 2
Neighs:    16.5 ave 50 max 0 min
Histogram: 8 3 2 8 4 3 1 0 1 2

Total # of neighbors = 528
Ave neighs/atom = 1.06237
Neighbor list builds = 107
Dangerous builds = 0
#shell cd ..
#clear
#next reps
#jump SELF
Total wall time: 0:00:24
