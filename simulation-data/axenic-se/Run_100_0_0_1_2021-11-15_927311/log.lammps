LAMMPS (20 Nov 2019)
# NUFEB simulation

atom_style	bio
atom_modify	map array sort 1000 5.0e-7
boundary	ff ff ff
newton		off
processors  * * *

comm_modify	vel yes
#variable reps loop 1
read_data_bio atom_100_0_0_1_2021-11-15.in
  orthogonal box = (0 0 0) to (0.0001 0.0001 0.0001)
  2 by 4 by 4 MPI processor grid
  reading atoms ...
  100 atoms
  4 nutrients
#shell mkdir Run_100_0_0_1
#shell cd Run_100_0_0_1
##############Define initial particle distribution##############

lattice sc 1e-6 origin 0 0 0
Lattice spacing in x,y,z = 100 100 100
region reg block 0 1000 0 1000 0 100

group CYANO type 1
100 atoms in group CYANO
group ECW type 2
0 atoms in group ECW

neighbor	5e-7 bin
neigh_modify	delay 0 one 5000

##############Define DEM Variables&Commands##############

pair_style  gran/hooke/history 1.e-4 NULL 1.e-5 NULL 0.0 1
pair_coeff  * *

timestep 10

fix 1 all nve/limit 1e-8
fix fv all viscous 1e-5

fix zw all wall/gran hooke/history 2000 NULL 500.0 NULL 1.5 0 zplane  0.0  0.0001

variable kanc equal 50

variable ke equal 5e+10


##############Define IBm Variables##############

#variables used in fix eps_extract
variable EPSdens equal 30
variable EPSratio equal 1.3

#variables used in fix division
variable divDia1 equal 1.96e-6
variable divDia2 equal 1.04e-6

#variables used in fix kinetics
variable diffT equal 1e-4
variable tol equal 1e-11
variable etaHET equal 0.6
variable layer equal -1

#variables used in fix death
#variable deadDia equal 9e-7


##############Define IBm Commands##############

fix k1 all kinetics 100 5 5 5 v_diffT v_layer niter 1000000
fix kgm all kinetics/growth/monod sucexp 0.0
fix g1 all kinetics/diffusion v_tol
fix d1 CYANO divide 100 v_EPSdens v_divDia1 148324
fix d2 ECW divide 100 v_EPSdens v_divDia2 77510
#fix d2 all death 1 v_deadDia demflag 0


##############Define IBm Computes##############

compute myNtypes all ntypes
compute myMass all biomass
compute myCon all avg_con

##############Simulation exit condition##############
variable co2 equal c_myCon[4]
fix 10 all halt 1000 v_co2 <= 1e-19

variable light equal c_myCon[1]
fix 11 all halt 1000 v_light <= 1e-19

##############Simulation Output##############



dump    du3 all bio 100 ntypes biomass avg_con
dump    traj all bio/hdf5 100 trajectory.h5 id type radius x y z con
thermo_style    custom step cpu atoms c_myNtypes[*] c_myMass[*] c_myCon[*]
thermo		100
thermo_modify	lost ignore


run 8700
Model is defined as a closed system. 
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 5000, page size: 100000
  master list distance cutoff = 2.43e-06
  ghost atom cutoff = 2.43e-06
  binsize = 1.215e-06, bins = 83 83 83
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair gran/hooke/history, perpetual
      attributes: half, newton off, size, history
      pair build: half/size/bin/newtoff
      stencil: half/bin/3d/newtoff
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.856 | 9.157 | 10.91 Mbytes
Step CPU Atoms c_myNtypes[1] c_myNtypes[2] c_myMass[1] c_myMass[2] c_myCon[1] c_myCon[2] c_myCon[3] c_myCon[4] 
       0            0      100          100            0 8.723006e-14            0          0.1        0.009     3.42e-20       0.0299 
number of iterations: 45012 
     100   0.54275171      100          100            0 8.8932025e-14            0          0.1 0.0090002821 1.3652283e-20   0.02989953 
number of iterations: 36302 
     200   0.94940525      100          100            0 9.0667199e-14            0          0.1 0.0090002876 1.0312519e-20  0.029899521 
number of iterations: 24800 
     300    1.2494215      100          100            0 9.2436227e-14            0          0.1 0.0090002932 9.7428695e-21  0.029899512 
number of iterations: 23889 
     400    1.5481864      104          104            0 9.4239772e-14            0          0.1 0.0090002989 1.0269507e-20  0.029899502 
number of iterations: 24103 
     500    1.8442667      106          106            0 9.6078506e-14            0          0.1 0.0090003048 9.7329539e-21  0.029899493 
number of iterations: 24068 
     600    2.1363578      108          108            0 9.7953115e-14            0          0.1 0.0090003107 1.0267057e-20  0.029899483 
number of iterations: 24060 
     700     2.435506      109          109            0 9.9864301e-14            0          0.1 0.0090003176 9.7323714e-21  0.029899471 
number of iterations: 24078 
     800     2.729195      112          112            0 1.0181278e-13            0          0.1 0.0090003238 1.0266934e-20  0.029899461 
number of iterations: 24058 
     900    3.0587813      112          112            0 1.0379927e-13            0          0.1 0.0090003301 9.732354e-21   0.02989945 
number of iterations: 24078 
    1000    3.3629317      113          113            0 1.0582452e-13            0          0.1 0.0090003365 1.0266951e-20   0.02989944 
number of iterations: 24058 
    1100     3.659631      114          114            0 1.0788929e-13            0          0.1 0.0090003431 9.7323367e-21  0.029899429 
number of iterations: 24079 
    1200    3.9572351      115          115            0 1.0999434e-13            0          0.1 0.0090003498 1.0266898e-20  0.029899418 
number of iterations: 24057 
    1300     4.252829      118          118            0 1.1214046e-13            0          0.1 0.0090003566 9.7323193e-21  0.029899406 
number of iterations: 24079 
    1400    4.5503785      120          120            0 1.1432846e-13            0          0.1 0.0090003636 1.0266916e-20  0.029899395 
number of iterations: 24058 
    1500    4.8506774      121          121            0 1.1655915e-13            0          0.1 0.0090003707 9.7323724e-21  0.029899383 
number of iterations: 24078 
    1600    5.1491288      123          123            0 1.1883336e-13            0          0.1 0.0090003779 1.0266933e-20  0.029899371 
number of iterations: 24058 
    1700     5.444911      123          123            0 1.2115195e-13            0          0.1 0.0090003853 9.7323551e-21  0.029899359 
number of iterations: 24078 
    1800     5.739922      125          125            0 1.2351577e-13            0          0.1 0.0090003926 1.0267633e-20  0.029899346 
number of iterations: 24070 
    1900    6.0399932      128          128            0 1.2592572e-13            0          0.1 0.0090004003 9.7318206e-21  0.029899334 
number of iterations: 24088 
    2000    6.3390389      130          130            0 1.2838268e-13            0          0.1 0.0090004081 1.0267468e-20  0.029899321 
number of iterations: 24067 
    2100    6.6367037      131          131            0 1.3088759e-13            0          0.1  0.009000416 9.7317758e-21  0.029899307 
number of iterations: 24089 
    2200    6.9354265      132          132            0 1.3344137e-13            0          0.1 0.0090004242 1.0267443e-20  0.029899294 
number of iterations: 24067 
    2300    7.2459902      134          134            0 1.3604497e-13            0          0.1 0.0090004359 9.731801e-21  0.029899274 
number of iterations: 24088 
    2400    7.5452834      137          137            0 1.3869937e-13            0          0.1 0.0090004444 1.0267487e-20   0.02989926 
number of iterations: 24068 
    2500    7.8451903      142          142            0 1.4140557e-13            0          0.1  0.009000453 9.7318261e-21  0.029899246 
number of iterations: 24088 
    2600    8.1450634      143          143            0 1.4416457e-13            0          0.1 0.0090004619 1.0267462e-20  0.029899231 
number of iterations: 24067 
    2700    8.4444276      144          144            0 1.4697739e-13            0          0.1 0.0090004709 9.7317813e-21  0.029899216 
number of iterations: 24088 
    2800    8.7429132      147          147            0 1.498451e-13            0          0.1 0.0090004801 1.0267507e-20  0.029899201 
number of iterations: 24068 
    2900    9.0418913      148          148            0 1.5276877e-13            0          0.1 0.0090004894 9.7318064e-21  0.029899185 
number of iterations: 24088 
    3000     9.332316      151          151            0 1.5574947e-13            0          0.1 0.0090004967 1.0182238e-20  0.029899173 
number of iterations: 22257 
    3100    9.6156783      152          152            0 1.5878834e-13            0          0.1 0.0090005064 9.7956918e-21  0.029899157 
number of iterations: 22804 
    3200    9.9384212      153          153            0 1.6188649e-13            0          0.1 0.0090005139 1.0197844e-20  0.029899144 
number of iterations: 22646 
    3300    10.225095      157          157            0 1.650451e-13            0          0.1  0.009000524 9.8000908e-21  0.029899128 
number of iterations: 22702 
    3400    10.511147      160          160            0 1.6826533e-13            0          0.1 0.0090005342 1.0198978e-20  0.029899111 
number of iterations: 22673 
    3500    10.803902      165          165            0 1.7154839e-13            0          0.1 0.0090005446 9.8003986e-21  0.029899093 
number of iterations: 22694 
    3600    11.093519      168          168            0 1.7489551e-13            0          0.1 0.0090005552 1.0199099e-20  0.029899076 
number of iterations: 22675 
    3700    11.381488      173          173            0 1.7830794e-13            0          0.1 0.0090005661 9.800384e-21  0.029899058 
number of iterations: 22695 
    3800    11.669902      175          175            0 1.8178695e-13            0          0.1 0.0090005771 1.019906e-20  0.029899039 
number of iterations: 22675 
    3900    11.959566      178          178            0 1.8533383e-13            0          0.1 0.0090005884 9.8004231e-21   0.02989902 
number of iterations: 22694 
    4000    12.250321      179          179            0 1.8894992e-13            0          0.1 0.0090005999 1.0199075e-20  0.029899001 
number of iterations: 22675 
    4100    12.534588      184          184            0 1.9263657e-13            0          0.1 0.0090006102 9.8021285e-21  0.029898984 
number of iterations: 22653 
    4200    12.848995      188          188            0 1.9639514e-13            0          0.1 0.0090006221 1.0197833e-20  0.029898964 
number of iterations: 22645 
    4300     13.15077      200          200            0 2.0022705e-13            0          0.1 0.0090006361 9.803635e-21  0.029898941 
number of iterations: 22617 
    4400    13.440651      202          202            0 2.0413373e-13            0          0.1 0.0090006486 1.0196354e-20   0.02989892 
number of iterations: 22610 
    4500    13.730866      206          206            0 2.0811663e-13            0          0.1 0.0090006612 9.8032949e-21  0.029898899 
number of iterations: 22625 
    4600    14.020199      207          207            0 2.1217724e-13            0          0.1 0.0090006741 1.0196279e-20  0.029898878 
number of iterations: 22608 
    4700    14.303024      213          213            0 2.1631708e-13            0          0.1 0.0090006837 9.8032618e-21  0.029898862 
number of iterations: 22626 
    4800    14.592661      220          220            0 2.2053769e-13            0          0.1 0.0090006982 1.0197012e-20  0.029898838 
number of iterations: 22626 
    4900    14.884899      226          226            0 2.2484065e-13            0          0.1 0.0090007118 9.8027142e-21  0.029898815 
number of iterations: 22639 
    5000    15.180399      230          230            0 2.2922757e-13            0          0.1  0.009000726 1.0195985e-20  0.029898791 
number of iterations: 22601 
    5100     15.47155      235          235            0 2.3370008e-13            0          0.1 0.0090007382 9.8021084e-21  0.029898771 
number of iterations: 22654 
    5200    15.762908      238          238            0 2.3825986e-13            0          0.1 0.0090007526 1.0197081e-20  0.029898747 
number of iterations: 22627 
    5300    16.055893      241          241            0 2.429086e-13            0          0.1 0.0090007664 9.8023421e-21  0.029898724 
number of iterations: 22648 
    5400    16.350467      246          246            0 2.4764804e-13            0          0.1 0.0090007813 1.0197156e-20  0.029898699 
number of iterations: 22629 
    5500    16.644075      252          252            0 2.5247996e-13            0          0.1 0.0090007969 9.8023698e-21  0.029898673 
number of iterations: 22647 
    5600    16.937328      261          261            0 2.5740615e-13            0          0.1 0.0090008124 1.019718e-20  0.029898647 
number of iterations: 22630 
    5700    17.230769      266          266            0 2.6242846e-13            0          0.1 0.0090008283 9.8023974e-21  0.029898621 
number of iterations: 22647 
    5800    17.524706      269          269            0 2.6754876e-13            0          0.1 0.0090008444 1.0197152e-20  0.029898594 
number of iterations: 22629 
    5900    17.819132      271          271            0 2.7276897e-13            0          0.1 0.0090008609 9.8023737e-21  0.029898567 
number of iterations: 22647 
    6000    18.116627      274          274            0 2.7809103e-13            0          0.1 0.0090008777 1.0197176e-20  0.029898539 
number of iterations: 22630 
    6100    18.413234      274          274            0 2.8351692e-13            0          0.1 0.0090008948 9.8024014e-21   0.02989851 
number of iterations: 22647 
    6200    18.713078      278          278            0 2.8904869e-13            0          0.1 0.0090009125 1.0197148e-20  0.029898481 
number of iterations: 22629 
    6300    19.008966      287          287            0 2.9468838e-13            0          0.1 0.0090009303 9.8023776e-21  0.029898451 
number of iterations: 22647 
    6400     19.30108      293          293            0 3.0043811e-13            0          0.1 0.0090009465 1.0197168e-20  0.029898424 
number of iterations: 22629 
    6500    19.596273      295          295            0 3.0630003e-13            0          0.1  0.009000965 9.8023622e-21  0.029898393 
number of iterations: 22648 
    6600    19.944418      303          303            0 3.1227632e-13            0          0.1 0.0090009864 1.0169235e-20  0.029898358 
number of iterations: 21907 
    6700    20.233814      307          307            0 3.1836921e-13            0          0.1 0.0090010057 9.8242879e-21  0.029898326 
number of iterations: 22079 
    6800    20.526258      316          316            0 3.2458098e-13            0          0.1 0.0090010263 1.0171931e-20  0.029898291 
number of iterations: 21970 
    6900    20.820825      320          320            0 3.3091396e-13            0          0.1 0.0090010463 9.8269674e-21  0.029898258 
number of iterations: 22006 
    7000    21.114037      323          323            0 3.3737049e-13            0          0.1 0.0090010667 1.0172531e-20  0.029898224 
number of iterations: 21987 
    7100    21.404194      331          331            0  3.43953e-13            0          0.1 0.0090010875 9.8271227e-21  0.029898189 
number of iterations: 22002 
    7200     21.69748      338          338            0 3.5066395e-13            0          0.1 0.0090011087 1.0172555e-20  0.029898154 
number of iterations: 21987 
    7300    21.993061      351          351            0 3.5750583e-13            0          0.1 0.0090011278 9.8268373e-21  0.029898122 
number of iterations: 22010 
    7400    22.282985      361          361            0 3.6448121e-13            0          0.1  0.009001149 1.0172748e-20  0.029898087 
number of iterations: 21993 
    7500    22.577354      362          362            0 3.7159268e-13            0          0.1 0.0090011715 9.8269105e-21  0.029898049 
number of iterations: 22008 
    7600    22.904339      368          368            0 3.7884291e-13            0          0.1 0.0090011943 1.0172764e-20  0.029898011 
number of iterations: 21993 
    7700    23.196458      374          374            0 3.862346e-13            0          0.1 0.0090012173 9.8268946e-21  0.029897973 
number of iterations: 22008 
    7800    23.491738      386          386            0 3.9377051e-13            0          0.1 0.0090012396 1.0173068e-20  0.029897936 
number of iterations: 22001 
    7900    23.786436      391          391            0 4.0145346e-13            0          0.1 0.0090012638 9.8266582e-21  0.029897896 
number of iterations: 22015 
    8000    24.084603      401          401            0 4.092863e-13            0          0.1 0.0090012866 1.0172993e-20  0.029897858 
number of iterations: 21999 
    8100    24.380505      409          409            0 4.1727198e-13            0          0.1 0.0090013129 9.8266442e-21  0.029897814 
number of iterations: 22015 
    8200    24.677396      421          421            0 4.2541347e-13            0          0.1 0.0090013373 1.0173007e-20  0.029897773 
number of iterations: 22000 
    8300    24.977316      429          429            0 4.337138e-13            0          0.1 0.0090013665 9.8266802e-21  0.029897725 
number of iterations: 22014 
    8400    25.274076      437          437            0 4.4217609e-13            0          0.1 0.0090013932 1.017301e-20   0.02989768 
number of iterations: 22000 
    8500    25.570676      444          444            0 4.5080349e-13            0          0.1 0.0090014204 9.8266772e-21  0.029897635 
number of iterations: 22014 
    8600    25.868775      457          457            0 4.5959921e-13            0          0.1 0.0090014481 1.0173013e-20  0.029897589 
number of iterations: 22000 
    8700     26.16609      466          466            0 4.6856656e-13            0          0.1 0.0090014763 9.8266741e-21  0.029897542 
Loop time of 26.1661 on 32 procs for 8700 steps with 466 atoms

Performance: 287272370.922 tau/day, 332.491 timesteps/s
98.7% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00041459 | 0.0024163  | 0.0070194  |   2.7 |  0.01
Neigh   | 0.0011659  | 0.0021531  | 0.0051684  |   1.8 |  0.01
Comm    | 0.010275   | 0.03441    | 0.053035   |   5.7 |  0.13
Output  | 0.82281    | 0.82334    | 0.82436    |   0.0 |  3.15
Modify  | 25.251     | 25.255     | 25.259     |   0.0 | 96.52
Other   |            | 0.04927    |            |       |  0.19

Nlocal:    14.5625 ave 57 max 0 min
Histogram: 5 11 4 7 2 2 0 0 0 1
Nghost:    7.15625 ave 21 max 0 min
Histogram: 6 8 4 4 1 2 4 1 1 1
Neighs:    16.0938 ave 62 max 0 min
Histogram: 5 10 6 5 3 2 0 0 0 1

Total # of neighbors = 515
Ave neighs/atom = 1.10515
Neighbor list builds = 109
Dangerous builds = 0
#shell cd ..
#clear
#next reps
#jump SELF
Total wall time: 0:00:26
