LAMMPS (20 Nov 2019)
# NUFEB simulation

atom_style	bio
atom_modify	map array sort 1000 5.0e-7
boundary	ff ff ff
newton		off
processors  * * *

comm_modify	vel yes
#variable reps loop 1
read_data_bio atom_50_0_20_1_2021-08-30.in
  orthogonal box = (0 0 0) to (0.0001 0.0001 5e-05)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  50 atoms
  4 nutrients
#shell mkdir Run_50_0_20_1
#shell cd Run_50_0_20_1
##############Define initial particle distribution##############

lattice sc 1e-6 origin 0 0 0
Lattice spacing in x,y,z = 100 100 100
region reg block 0 1000 0 1000 0 100

group CYANO type 1
50 atoms in group CYANO
group ECW type 2
0 atoms in group ECW

neighbor	5e-7 bin
neigh_modify	delay 0 one 5000

##############Define DEM Variables&Commands##############

pair_style  gran/hooke/history 1.e-4 NULL 1.e-5 NULL 0.0 1
pair_coeff  * *

timestep 10

fix 1 all nve/limit 1e-8
fix fv all viscous 1e-5

fix zw all wall/gran hooke/history 2000 NULL 500.0 NULL 1.5 0 zplane  0.0  5e-05

variable kanc equal 50

variable ke equal 5e+10


##############Define IBm Variables##############

#variables used in fix eps_extract
variable EPSdens equal 30
variable EPSratio equal 1.3

#variables used in fix division
variable divDia1 equal 1.96e-6
variable divDia2 equal 1.04e-6

#variables used in fix kinetics
variable diffT equal 1e-4
variable tol equal 1e-11
variable etaHET equal 0.6
variable layer equal -1

#variables used in fix death
#variable deadDia equal 9e-7


##############Define IBm Commands##############

fix k1 all kinetics 100 10 10 5 v_diffT v_layer niter 1000000
fix kgm all kinetics/growth/monod sucexp 0.2
fix g1 all kinetics/diffusion v_tol
fix d1 CYANO divide 100 v_EPSdens v_divDia1 523355
fix d2 ECW divide 100 v_EPSdens v_divDia2 243557
#fix d2 all death 1 v_deadDia demflag 0


##############Define IBm Computes##############

compute myNtypes all ntypes
compute myMass all biomass
compute myCon all avg_con

##############Simulation exit condition##############
variable co2 equal c_myCon[4]
fix 10 all halt 100 v_co2 <= 1e-19

variable light equal c_myCon[1]
fix 11 all halt 100 v_light <= 1e-19

##############Simulation Output##############
dump    id all custom 100 output.lammmps id type diameter x y z
dump    du1 all vtk 100 atom_*.vtu id type diameter x y z
dump    du2 all grid 100 grid_%_*.vti con
dump    du3 all bio 100 ntypes biomass avg_con
dump    traj all bio/hdf5 100 trajectory.h5 id type radius x y z con
thermo_style    custom step cpu atoms c_myNtypes[*] c_myMass[*] c_myCon[*]
thermo		100
thermo_modify	lost ignore


run 10000
Model is defined as a closed system. 
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 5000, page size: 100000
  master list distance cutoff = 2.44e-06
  ghost atom cutoff = 2.44e-06
  binsize = 1.22e-06, bins = 82 82 41
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair gran/hooke/history, perpetual
      attributes: half, newton off, size, history
      pair build: half/size/bin/newtoff
      stencil: half/bin/3d/newtoff
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 7.032 | 11.55 | 12.34 Mbytes
Step CPU Atoms c_myNtypes[1] c_myNtypes[2] c_myMass[1] c_myMass[2] c_myCon[1] c_myCon[2] c_myCon[3] c_myCon[4] 
       0            0       50           50            0 4.3988783e-14            0          0.1        0.009     3.42e-20       0.0299 
number of iterations: 324284 
     100    5.2340374       50           50            0 4.4846243e-14            0          0.1 0.0090015827 0.0017429797  0.029897365 
number of iterations: 21246 
     200    5.8586333       50           50            0 4.5720416e-14            0          0.1 0.0090016136  0.003464954  0.029897314 
number of iterations: 21331 
     300    6.4512104       51           51            0 4.661163e-14            0          0.1  0.009001645 0.0052203249  0.029897261 
number of iterations: 21416 
     400    7.0722952       52           52            0 4.7520216e-14            0          0.1 0.0090016771 0.0070098229  0.029897208 
number of iterations: 21502 
     500    7.6633314       52           52            0 4.8446512e-14            0          0.1 0.0090017098 0.0088341429  0.029897154 
number of iterations: 21598 
     600    8.2756993       53           53            0 4.9390865e-14            0          0.1 0.0090017431  0.010693981  0.029897098 
number of iterations: 21671 
     700    8.8883315       53           53            0 5.0353625e-14            0          0.1 0.0090017771  0.012590037  0.029897042 
number of iterations: 21757 
     800     9.524659       54           54            0 5.1335153e-14            0          0.1 0.0090018118  0.014523023  0.029896984 
number of iterations: 21842 
     900    10.144089       54           54            0 5.2335812e-14            0          0.1 0.0090018471  0.016493662  0.029896925 
number of iterations: 21927 
    1000    10.712122       55           55            0 5.3355978e-14            0          0.1 0.0090018831  0.018502693  0.029896865 
number of iterations: 22012 
    1100    11.305022       55           55            0 5.4396029e-14            0          0.1 0.0090019198  0.020550865  0.029896804 
number of iterations: 22097 
    1200    11.966385       56           56            0 5.5456353e-14            0          0.1 0.0090019572  0.022638943  0.029896742 
number of iterations: 22182 
    1300     12.58894       57           57            0 5.6537346e-14            0          0.1 0.0090019954  0.024767708  0.029896678 
number of iterations: 22268 
    1400    13.230453       58           58            0 5.7639411e-14            0          0.1 0.0090020343  0.026937953  0.029896613 
number of iterations: 22363 
    1500    13.820577       58           58            0 5.8762957e-14            0          0.1 0.0090020739  0.029150488  0.029896547 
number of iterations: 22980 
    1600    14.452964       64           64            0 5.9908405e-14            0          0.1 0.0090021182  0.031406142  0.029896474 
number of iterations: 22577 
    1700    15.186997       64           64            0 6.107618e-14            0          0.1 0.0090021595  0.033705753  0.029896405 
number of iterations: 22680 
    1800    15.947051       64           64            0 6.2266719e-14            0          0.1 0.0090022015  0.036050177  0.029896335 
number of iterations: 22782 
    1900    16.623205       64           64            0 6.3480464e-14            0          0.1 0.0090022445  0.038440291  0.029896263 
number of iterations: 22885 
    2000    17.264684       64           64            0 6.4717869e-14            0          0.1 0.0090022882  0.040876984   0.02989619 
number of iterations: 22987 
    2100    17.988765       64           64            0 6.5979393e-14            0          0.1 0.0090023328  0.043361164  0.029896116 
number of iterations: 21762 
    2200     18.59813       67           67            0 6.7265508e-14            0          0.1 0.0090023696  0.045893766  0.029896055 
number of iterations: 23167 
    2300    19.211623       67           67            0 6.8576693e-14            0          0.1 0.0090024158  0.048475726  0.029895978 
number of iterations: 23269 
    2400    19.817676       67           67            0 6.9913437e-14            0          0.1 0.0090024629  0.051108007    0.0298959 
number of iterations: 23372 
    2500    20.454324       72           72            0 7.1276237e-14            0          0.1  0.009002511   0.05379159   0.02989582 
number of iterations: 23474 
    2600    21.056554       72           72            0 7.2665602e-14            0          0.1 0.0090025599  0.056527475  0.029895738 
number of iterations: 23577 
    2700    21.660074       72           72            0 7.4082049e-14            0          0.1 0.0090026098  0.059316683  0.029895655 
number of iterations: 23679 
    2800    22.295768       72           72            0 7.5526106e-14            0          0.1 0.0090026607  0.062160252   0.02989557 
number of iterations: 23782 
    2900    22.976345       74           74            0 7.6998312e-14            0          0.1 0.0090027126  0.065059244  0.029895484 
number of iterations: 23884 
    3000    23.595383       75           75            0 7.8499216e-14            0          0.1 0.0090027654  0.068014741  0.029895396 
number of iterations: 23987 
    3100    24.196591       77           77            0 8.0029375e-14            0          0.1 0.0090028193  0.071027845  0.029895306 
number of iterations: 24092 
    3200    24.793114       79           79            0 8.1589362e-14            0          0.1 0.0090028743  0.074099679  0.029895215 
number of iterations: 24204 
    3300    25.403021       81           81            0 8.3179757e-14            0          0.1 0.0090029303   0.07723139  0.029895121 
number of iterations: 24307 
    3400    25.996731       83           83            0 8.4801153e-14            0          0.1 0.0090029875  0.080424139  0.029895026 
number of iterations: 24397 
    3500     26.59442       84           84            0 8.6454154e-14            0          0.1 0.0090030457   0.08367912  0.029894929 
number of iterations: 24500 
    3600     27.23396       86           86            0 8.8139377e-14            0          0.1 0.0090031051  0.086997546   0.02989483 
number of iterations: 24603 
    3700     27.84294       87           87            0 8.9857449e-14            0          0.1 0.0090031656  0.090380654   0.02989473 
number of iterations: 24710 
    3800    28.495985       90           90            0 9.1609011e-14            0          0.1 0.0090032273  0.093829704  0.029894627 
number of iterations: 24808 
    3900    29.100287       92           92            0 9.3394716e-14            0          0.1 0.0090032902  0.097345982  0.029894522 
number of iterations: 24910 
    4000    29.714825       95           95            0 9.5215229e-14            0          0.1 0.0090033544    0.1009308  0.029894415 
number of iterations: 25013 
    4100    30.322688       96           96            0 9.7071228e-14            0          0.1 0.0090034198   0.10458549  0.029894306 
number of iterations: 25112 
    4200    31.004726       98           98            0 9.8963406e-14            0          0.1 0.0090034864   0.10831142  0.029894195 
number of iterations: 25231 
    4300    31.631015      100          100            0 1.0089247e-13            0          0.1 0.0090035544   0.11210998  0.029894082 
number of iterations: 25059 
    4400    32.262203      104          104            0 1.0285913e-13            0          0.1 0.0090036211   0.11598258  0.029893971 
number of iterations: 25420 
    4500    32.881371      106          106            0 1.0486413e-13            0          0.1 0.0090036917   0.11993067  0.029893854 
number of iterations: 25522 
    4600    33.549015      107          107            0 1.0690821e-13            0          0.1 0.0090037637   0.12395572  0.029893734 
number of iterations: 25630 
    4700    34.172634      108          108            0 1.0899214e-13            0          0.1  0.009003837   0.12805922  0.029893612 
number of iterations: 25728 
    4800    34.861509      110          110            0 1.1111669e-13            0          0.1 0.0090039118    0.1322427  0.029893487 
number of iterations: 26395 
    4900    35.522255      112          112            0 1.1328265e-13            0          0.1 0.0090039957   0.13650774  0.029893347 
number of iterations: 25945 
    5000    36.189771      114          114            0 1.1549083e-13            0          0.1 0.0090040736    0.1408559  0.029893218 
number of iterations: 26048 
    5100    36.843082      116          116            0 1.1774205e-13            0          0.1  0.009004153   0.14528882  0.029893085 
number of iterations: 26151 
    5200    37.460826      116          116            0 1.2003716e-13            0          0.1 0.0090042339   0.14980815  0.029892951 
number of iterations: 26488 
    5300    38.166194      120          120            0  1.22377e-13            0          0.1 0.0090043194   0.15441557  0.029892808 
number of iterations: 26777 
    5400    38.831275      124          124            0 1.2476246e-13            0          0.1  0.009004409   0.15911279  0.029892659 
number of iterations: 26306 
    5500    39.496678      127          127            0 1.2719441e-13            0          0.1 0.0090044936   0.16390157  0.029892518 
number of iterations: 26572 
    5600      40.1156      129          129            0 1.2967377e-13            0          0.1 0.0090045812    0.1687837  0.029892372 
number of iterations: 26678 
    5700    40.762242      130          130            0 1.3220146e-13            0          0.1 0.0090046705   0.17376099  0.029892224 
number of iterations: 26777 
    5800    41.512905      130          130            0 1.3477841e-13            0          0.1 0.0090047616    0.1788353  0.029892072 
number of iterations: 26895 
    5900    42.272067      133          133            0 1.3740561e-13            0          0.1 0.0090048544   0.18400853  0.029891918 
number of iterations: 27006 
    6000    42.957116      137          137            0 1.4008401e-13            0          0.1  0.009004949   0.18928261   0.02989176 
number of iterations: 27088 
    6100    43.642952      140          140            0 1.4281462e-13            0          0.1 0.0090050455    0.1946595  0.029891599 
number of iterations: 26817 
    6200    44.306297      144          144            0 1.4559845e-13            0          0.1 0.0090051387   0.20014121  0.029891444 
number of iterations: 27287 
    6300    44.980985      145          145            0 1.4843656e-13            0          0.1 0.0090052389   0.20572977  0.029891277 
number of iterations: 27391 
    6400    45.647361      145          145            0 1.5132998e-13            0          0.1  0.009005341   0.21142726  0.029891107 
number of iterations: 27497 
    6500    46.305131      148          148            0 1.542798e-13            0          0.1 0.0090054451   0.21723581  0.029890934 
number of iterations: 27596 
    6600    46.962573      150          150            0 1.5728713e-13            0          0.1 0.0090055513   0.22315758  0.029890757 
number of iterations: 27700 
    6700    47.641226      154          154            0 1.6035307e-13            0          0.1 0.0090056595   0.22919478  0.029890577 
number of iterations: 28116 
    6800    48.351077      161          161            0 1.6347878e-13            0          0.1  0.009005775   0.23534966  0.029890385 
number of iterations: 27913 
    6900    49.034441      162          162            0 1.6666541e-13            0          0.1 0.0090058876   0.24162451  0.029890197 
number of iterations: 28025 
    7000    49.706856      165          165            0 1.6991417e-13            0          0.1 0.0090060024   0.24802167  0.029890006 
number of iterations: 28300 
    7100    50.414032      168          168            0 1.7322625e-13            0          0.1 0.0090061225   0.25454351  0.029889806 
number of iterations: 28232 
    7200    51.105386      171          171            0 1.7660288e-13            0          0.1 0.0090062418   0.26119249  0.029889607 
number of iterations: 28335 
    7300    51.822068      175          175            0 1.8004534e-13            0          0.1 0.0090063635   0.26797105  0.029889405 
number of iterations: 28439 
    7400     52.49926      177          177            0 1.8355491e-13            0          0.1 0.0090064875   0.27488174  0.029889198 
number of iterations: 28537 
    7500    53.219223      180          180            0 1.8713288e-13            0          0.1  0.009006614   0.28192713  0.029888988 
number of iterations: 29135 
    7600    53.935008      188          188            0 1.9078059e-13            0          0.1 0.0090067539   0.28910983  0.029888755 
number of iterations: 28756 
    7700     54.63943      192          192            0 1.9449941e-13            0          0.1 0.0090068855   0.29643253  0.029888536 
number of iterations: 28862 
    7800    55.388162      193          193            0 1.9829072e-13            0          0.1 0.0090070198   0.30389797  0.029888312 
number of iterations: 28961 
    7900    56.127226      198          198            0 2.0215593e-13            0          0.1 0.0090071566   0.31150893  0.029888084 
number of iterations: 29196 
    8000    56.891969      205          205            0 2.0609649e-13            0          0.1 0.0090072987   0.31926825  0.029887848 
number of iterations: 28906 
    8100     57.61011      211          211            0 2.1011386e-13            0          0.1 0.0090074354   0.32717881   0.02988762 
number of iterations: 29269 
    8200    58.397935      214          214            0 2.1420953e-13            0          0.1 0.0090075803   0.33524356  0.029887379 
number of iterations: 29372 
    8300    59.147172      218          218            0 2.1838504e-13            0          0.1 0.0090077281   0.34346552  0.029887133 
number of iterations: 29758 
    8400     59.88186      221          221            0 2.2264194e-13            0          0.1 0.0090078854   0.35184774  0.029886871 
number of iterations: 29435 
    8500    60.583901      226          226            0 2.2698183e-13            0          0.1 0.0090080355   0.36039335  0.029886621 
number of iterations: 29527 
    8600    61.333651      228          228            0 2.314063e-13            0          0.1 0.0090081885   0.36910553  0.029886366 
number of iterations: 29786 
    8700    62.135627      229          229            0 2.3591702e-13            0          0.1 0.0090083482   0.37798752    0.0298861 
number of iterations: 29693 
    8800    62.887198      236          236            0 2.4051567e-13            0          0.1 0.0090085051   0.38704263  0.029885839 
number of iterations: 30095 
    8900    63.695835      244          244            0 2.4520395e-13            0          0.1 0.0090086735   0.39627424  0.029885558 
number of iterations: 30095 
    9000    64.420181      246          246            0 2.4998363e-13            0          0.1 0.0090088426   0.40568579  0.029885277 
number of iterations: 30198 
    9100    65.162095      251          251            0 2.5485647e-13            0          0.1  0.009009015    0.4152808   0.02988499 
number of iterations: 30300 
    9200    65.896509      255          255            0 2.5982429e-13            0          0.1 0.0090091907   0.42506284  0.029884697 
number of iterations: 30543 
    9300    66.649649      263          263            0 2.6488895e-13            0          0.1 0.0090093737   0.43503556  0.029884393 
number of iterations: 30512 
    9400     67.37365      266          266            0 2.7005234e-13            0          0.1 0.0090095564   0.44520268  0.029884088 
number of iterations: 30745 
    9500    68.164825      273          273            0 2.7531637e-13            0          0.1 0.0090097462   0.45556797  0.029883772 
number of iterations: 30723 
    9600    69.017349      277          277            0 2.8068301e-13            0          0.1 0.0090099361    0.4661353  0.029883456 
number of iterations: 30825 
    9700    69.775411      280          280            0 2.8615426e-13            0          0.1 0.0090101298   0.47690862  0.029883133 
number of iterations: 30930 
    9800    70.521033      286          286            0 2.9173216e-13            0          0.1 0.0090103273   0.48789193  0.029882805 
number of iterations: 31576 
    9900    71.293164      293          293            0 2.9741879e-13            0          0.1 0.0090105498   0.49908935  0.029882434 
number of iterations: 31148 
   10000    72.075549      296          296            0 3.0321626e-13            0          0.1 0.0090107554   0.51050504  0.029882092 
Loop time of 72.0756 on 8 procs for 10000 steps with 296 atoms

Performance: 119874132.369 tau/day, 138.743 timesteps/s
87.3% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.010022   | 0.011786   | 0.013274   |   1.0 |  0.02
Neigh   | 0.0070505  | 0.0082773  | 0.0094731  |   1.1 |  0.01
Comm    | 0.049461   | 0.057542   | 0.06808    |   2.6 |  0.08
Output  | 13.529     | 13.53      | 13.532     |   0.0 | 18.77
Modify  | 58.395     | 58.398     | 58.4       |   0.0 | 81.02
Other   |            | 0.07087    |            |       |  0.10

Nlocal:    37 ave 49 max 22 min
Histogram: 1 1 0 0 1 2 0 0 1 2
Nghost:    9.5 ave 14 max 4 min
Histogram: 1 0 0 2 0 2 0 0 1 2
Neighs:    42.875 ave 58 max 24 min
Histogram: 1 1 0 0 1 2 0 0 1 2

Total # of neighbors = 343
Ave neighs/atom = 1.15878
Neighbor list builds = 112
Dangerous builds = 0
#shell cd ..
#clear
#next reps
#jump SELF
Total wall time: 0:01:12
